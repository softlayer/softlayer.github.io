<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>User Access Details - https://sldn.softlayer.com/</title>
    <link rel="canonical" href="https://sldn.softlayer.com/python/user_access_details/">
        <link href="https://sldn.softlayer.com/css/main.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/bootstrap.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/custom.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/monokai.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/highlight/solarized_dark.css" rel="stylesheet">

    <script src="https://sldn.softlayer.com/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://sldn.softlayer.com/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://sldn.softlayer.com/js/jquery-3.3.1.min.js"></script> 
    <script src="https://sldn.softlayer.com/js/sldn.js"></script>


    <link href="https://sldn.softlayer.com/fontawesome/css/fontawesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/brands.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/solid.min.css" rel="stylesheet" type="text/css">
    
    <script defer src="https://sldn.softlayer.com/fontawesome/js/solid.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/brands.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/fontawesome.min.js"></script>

    <script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
		})
	</script>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9XPZ9ZBSJE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-9XPZ9ZBSJE', { 'anonymize_ip': false });
}
</script>

</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://sldn.softlayer.com/">SoftLayer API</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                        <li><a href="https://sldn.softlayer.com/article/">Articles</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/reference/softlayerapi">Documentation</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/go/">Go</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/java/">Java</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/perl/">Perl</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/php/">PHP</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/python/">Python</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/rest/">Rest</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/ruby/">Ruby</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/tools/">Tools</a></li>
                    

                    
                </ul>
                <div id="custom-search-input" class="pull-right">
                  <form class="navbar-form" role="search" method="get" action="https://www.bing.com/search">
                    <div class="input-group col-md-12">
                      <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                      <input type="hidden" name="q1" value="site:sldn.softlayer.com" />
                      <div class="input-group-btn">
                        <button class="btn btn-info" type="submit">
                          <i class="glyphicon glyphicon-search"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>September 11, 2018<br></h4>
            </div>
        </div>
        <div class="col-md-9">

                <strong>Classes <span class="fa fa-book"/></strong>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Account">SoftLayer_Account</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Virtual_DedicatedHost">SoftLayer_Virtual_DedicatedHost</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Hardware">SoftLayer_Hardware</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_User_Customer">SoftLayer_User_Customer</a>
                
                <br>
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/users">users</a>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/permissions">permissions</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
		<div class="col-md-12">
            <div class="well well-sm  article" style="word-wrap: break-word;">
                <div class="article-title">
				    <h1>User Access Details</h1>
                    <small>Prints out a list of users, and what devices they have access to view.</small>
                </div>
				
                
				
                <p>This script gets each user, and which dedicatedHosts, hardware, and virtual guests they have permissions to view.</p>
<p>The hasFullAccessFlags are used to determine if a user has access to ALL hosts of that type or not. We are using that flag here to condense the output, but each user will still have the full list of hardware under their account if they have access to all.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">List of users that have access to a certain set of devices.
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">SoftLayer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># For nice debug output:</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span> <span class="k">as</span> <span class="n">pp</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">prettytable</span> <span class="kn">import</span> <span class="n">PrettyTable</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">click</span> <span class="kn">import</span> <span class="n">formatting</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">SoftLayer.CLI</span> <span class="kn">import</span> <span class="n">formatting</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">objectMask</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;mask[id, username, 
</span></span></span><span class="line"><span class="cl"><span class="s2">    dedicatedHosts[id,name,datacenter],
</span></span></span><span class="line"><span class="cl"><span class="s2">    virtualGuests[id,hostname,domain,datacenter],
</span></span></span><span class="line"><span class="cl"><span class="s2">    hardware[id,hostname,domain,datacenter],
</span></span></span><span class="line"><span class="cl"><span class="s2">    hasFullDedicatedHostAccessFlag,
</span></span></span><span class="line"><span class="cl"><span class="s2">    hasFullHardwareAccessFlag,
</span></span></span><span class="line"><span class="cl"><span class="s2">    hasFullVirtualGuestAccessFlag]&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">client</span> <span class="o">=</span> <span class="n">SoftLayer</span><span class="o">.</span><span class="n">create_client_from_env</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Gets all users on the account, 10 at a time. Accounts with a lot of devices may need to turn limit down to 1</span>
</span></span><span class="line"><span class="cl"><span class="n">all_users</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">call</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;SoftLayer_Account&#39;</span><span class="p">,</span> <span class="s1">&#39;getUsers&#39;</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">objectMask</span><span class="p">,</span> <span class="nb">iter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">table</span> <span class="o">=</span> <span class="n">PrettyTable</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;DATACENTER&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;-------------------- List of users that have access to a certain set of devices ---------------&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Iterate through each user, getting what devices they each have access to and printing that.</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">all_users</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">userId</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">THE USER: </span><span class="si">%s</span><span class="s2">  WITH ID: </span><span class="si">%s</span><span class="s2"> HAS ACCESS TO THE FOLLOWING DEVICES</span><span class="se">\n</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">userId</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hasFullDedicatedHostAccessFlag&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&#34;*&#34;</span><span class="p">,</span><span class="s2">&#34;Full Access&#34;</span><span class="p">,</span> <span class="s2">&#34;*&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="s1">&#39;dedicatedHosts&#39;</span> <span class="ow">in</span> <span class="n">user</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">dedicatedHosts</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;dedicatedHosts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">dedicatedHost</span> <span class="ow">in</span> <span class="n">dedicatedHosts</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">                <span class="n">dedicatedHost</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> 
</span></span><span class="line"><span class="cl">                <span class="n">dedicatedHost</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> 
</span></span><span class="line"><span class="cl">                <span class="n">dedicatedHost</span><span class="p">[</span><span class="s1">&#39;datacenter&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&#34;*&#34;</span><span class="p">,</span><span class="s2">&#34;No Access&#34;</span><span class="p">,</span> <span class="s2">&#34;*&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">table</span><span class="o">.</span><span class="n">clear_rows</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">get_string</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;DEDICATED HOST&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hasFullVirtualGuestAccessFlag&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&#34;*&#34;</span><span class="p">,</span><span class="s2">&#34;Full Access&#34;</span><span class="p">,</span> <span class="s2">&#34;*&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="s1">&#39;virtualGuests&#39;</span> <span class="ow">in</span> <span class="n">user</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">virtualGuests</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;virtualGuests&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="n">virtualGuests</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">                <span class="n">host</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> 
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">host</span><span class="p">[</span><span class="s1">&#39;hostname&#39;</span><span class="p">],</span> <span class="n">host</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">]),</span>
</span></span><span class="line"><span class="cl">                <span class="n">host</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;datacenter&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&#34;*&#34;</span><span class="p">,</span><span class="s2">&#34;No Access&#34;</span><span class="p">,</span> <span class="s2">&#34;*&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">get_string</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;VIRTUAL GUEST&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">table</span><span class="o">.</span><span class="n">clear_rows</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;hasFullVirtualGuestAccessFlag&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&#34;*&#34;</span><span class="p">,</span><span class="s2">&#34;Full Access&#34;</span><span class="p">,</span> <span class="s2">&#34;*&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="s1">&#39;hardware&#39;</span> <span class="ow">in</span> <span class="n">user</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">hardware</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;hardware&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="n">hardware</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">                <span class="n">host</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> 
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">host</span><span class="p">[</span><span class="s1">&#39;hostname&#39;</span><span class="p">],</span> <span class="n">host</span><span class="p">[</span><span class="s1">&#39;domain&#39;</span><span class="p">])</span> <span class="p">,</span> 
</span></span><span class="line"><span class="cl">                <span class="n">host</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;datacenter&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">table</span><span class="o">.</span><span class="n">add_row</span><span class="p">([</span><span class="s2">&#34;*&#34;</span><span class="p">,</span><span class="s2">&#34;No Access&#34;</span><span class="p">,</span> <span class="s2">&#34;*&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">get_string</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;HARDWARE&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">table</span><span class="o">.</span><span class="n">clear_rows</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Done&#34;</span><span class="p">)</span>
</span></span></code></pre></div>
            </div>
        </div>

    </div>
    <hr>
    <div class="row">
        <div class="row">
            <div class="col-md-6">
    <div class="well well-sm" style="word-wrap: break-word;"> 
        <strong>Feedback? <span class="fas fa-comment"/></strong>
            <p>
                If this article contains any error, or leaves any of your questions unanswered, please help us out by 
                opening up a github issue.<br>
                <a class="" href="https://github.com/softlayer/githubio_source/issues/new?title=Feedback%20for%20python%20-%20User%20Access%20Details&body=Feedback+regarding%3A%20https%3a%2f%2fsldn.softlayer.com%2fpython%2fuser_access_details%2f"> Open an issue</a>
                <i class="fab fa-github" alt="github"></i>
            </p>
    </div>
</div>
        </div>
    </div>
<footer>
    <div class="row">
        <div class="col-sm-12">
            <p>&copy; SoftLayer 2023<br>
            Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
        </div>
    </div>
</footer>
</div>

    <script src="https://sldn.softlayer.com/js/jquery.js"></script>
    <script src="https://sldn.softlayer.com/js/bootstrap.js"></script>
</body>
</html>

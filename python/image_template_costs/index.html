<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>Image Template Costs - https://sldn.softlayer.com/</title>
    <link rel="canonical" href="https://sldn.softlayer.com/python/image_template_costs/">
        <link href="https://sldn.softlayer.com/css/main.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/bootstrap.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/fa-svg-with-js.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/custom.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/highlight/solarized_dark.css" rel="stylesheet">

    <script src="https://sldn.softlayer.com/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://sldn.softlayer.com/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://sldn.softlayer.com/js/jquery-3.3.1.min.js"></script> 
    <script src="https://sldn.softlayer.com/js/sldn.js"></script>
    <script src="https://sldn.softlayer.com/js/fontawesome-all.js"></script>

    <script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
		})
	</script>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-88235803-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://sldn.softlayer.com/">SoftLayer API</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                        <li><a href="https://sldn.softlayer.com/article/">Articles</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/reference/softlayerapi">Documentation</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/go/">Go</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/java/">Java</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/perl/">Perl</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/python/">Python</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/rest/">Rest</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/ruby/">Ruby</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/tools/">Tools</a></li>
                    

                    
                </ul>
                <div id="custom-search-input" class="pull-right">
                  <form class="navbar-form" role="search" method="get" action="https://www.bing.com/search">
                    <div class="input-group col-md-12">
                      <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                      <input type="hidden" name="q1" value="site:sldn.softlayer.com" />
                      <div class="input-group-btn">
                        <button class="btn btn-info" type="submit">
                          <i class="glyphicon glyphicon-search"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>October 25, 2019<br></h4>
            </div>
        </div>
        <div class="col-md-9">

                <strong>Classes <span class="fa fa-book"/></strong>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Virtual_Storage_Repository">SoftLayer_Virtual_Storage_Repository</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Virtual_Guest_Block_Device_Template_Group">SoftLayer_Virtual_Guest_Block_Device_Template_Group</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Network_Component_Firewall">SoftLayer_Network_Component_Firewall</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Network_Firewall_Update_Request_Rule">SoftLayer_Network_Firewall_Update_Request_Rule</a>
                
                <br>
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/template">template</a>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/billing">billing</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
		<div class="col-md-12">
            <div class="well well-sm release-note" style="word-wrap: break-word;">
				<h3>Image Template Costs<br> <small>A ROUGH estimate for how much all the image templates on your account will cost.</small></h3>
				
                
				
                <p>The way this script works is that first it gets your last invoice, and finds all the <code>Image Template</code> items on it and builds a list of those, with their cost.</p>
<p>Then it goes through all your current image templates, correlates the templates Storage_Repository, and child templates with what was on your last invoice, and does some very basic math to come up with a next month cost.</p>
<p>Be aware that the next month cost assumes the template has existed in the repository for the entire month. So the result this script returns may not match exactly with what is on your next bill. This script also is not able to estimate cost of images that have been delete in the current month.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">Image template cost calculator.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">SoftLayer stores image templates in a SoftLayer_Virtual_Storage_Repository, which has a collection of other templates.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">You are billed per Storage_Repository, based on the images size on disk (not actual disk size).</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">An image template created mid-month will result in a smaller bill than calcualted. </span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">It is not possible for this script to pull usage data for images that have been deleted, so those are not included in these estimates.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">Any entry in the CSV output that has a number for the first column means that Storage_Repo was delete since the last bill.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span>
 
<span style="color:#f92672">import</span> SoftLayer
<span style="color:#f92672">from</span> pprint <span style="color:#f92672">import</span> pprint <span style="color:#66d9ef">as</span> pp
<span style="color:#f92672">import</span> logging
<span style="color:#f92672">import</span>  click

 
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">example</span>():
 
    <span style="color:#66d9ef">def</span> __init__(self):
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">       :param int start: epoch time to start at. Should align to 00:00 UTC</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">       :param int end: epoch time to end at. Should align to 00:00 UTC</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">       </span><span style="color:#e6db74">&#34;&#34;&#34;</span>
        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>Client()
        debugger <span style="color:#f92672">=</span> SoftLayer<span style="color:#f92672">.</span>DebugTransport(self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport)
        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport <span style="color:#f92672">=</span> debugger
 
        <span style="color:#75715e"># logger = logging.getLogger()</span>
        <span style="color:#75715e"># logger.addHandler(logging.StreamHandler())</span>
   
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">debug</span>(self):
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        Useful for printing out the exact API calls that were used. If using the rest transport, will print cure-able commands.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        </span><span style="color:#e6db74">&#34;&#34;&#34;</span>
        <span style="color:#66d9ef">for</span> call <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport<span style="color:#f92672">.</span>get_last_calls():
            <span style="color:#66d9ef">print</span>(self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>transport<span style="color:#f92672">.</span>print_reproduceable(call))
 
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(self):
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        Goes through all image templates on your account and tries to figure out how much they will cost next month.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        These costs are ESTIMATES and assumes the image template exists on your account for the entire month.</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        </span><span style="color:#e6db74">&#34;&#34;&#34;</span>

        storage_repos <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>lastInvoiceRepos()
        mask <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">mask[children[blockDevicesDiskSpaceTotal,storageRepository[id,datacenter,name,metricTrackingObject,billingItem[item[activeUsagePrices]]]]]</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
        objects <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Account</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">getPrivateBlockDeviceTemplateGroups</span><span style="color:#e6db74">&#39;</span>, mask<span style="color:#f92672">=</span>mask, iter<span style="color:#f92672">=</span>True, limit<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
        <span style="color:#66d9ef">for</span> _object <span style="color:#f92672">in</span> objects:

            <span style="color:#66d9ef">for</span> child <span style="color:#f92672">in</span> _object[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">children</span><span style="color:#e6db74">&#39;</span>]:
                <span style="color:#66d9ef">try</span>:
                    repo_id <span style="color:#f92672">=</span> child[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">storageRepository</span><span style="color:#e6db74">&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">id</span><span style="color:#e6db74">&#39;</span>]
                    repo_name <span style="color:#f92672">=</span> child[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">storageRepository</span><span style="color:#e6db74">&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">name</span><span style="color:#e6db74">&#39;</span>]

                    metric_id <span style="color:#f92672">=</span> child[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">storageRepository</span><span style="color:#e6db74">&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">metricTrackingObject</span><span style="color:#e6db74">&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">id</span><span style="color:#e6db74">&#39;</span>]
                    rate <span style="color:#f92672">=</span> float(child[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">storageRepository</span><span style="color:#e6db74">&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">billingItem</span><span style="color:#e6db74">&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">item</span><span style="color:#e6db74">&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">activeUsagePrices</span><span style="color:#e6db74">&#39;</span>][<span style="color:#ae81ff">0</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">usageRate</span><span style="color:#e6db74">&#39;</span>])
                    size <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>convert(child[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">blockDevicesDiskSpaceTotal</span><span style="color:#e6db74">&#39;</span>])

                    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> storage_repos<span style="color:#f92672">.</span>get(repo_id):
                        storage_repos[repo_id] <span style="color:#f92672">=</span> {<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">images</span><span style="color:#e6db74">&#39;</span>:[], <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">name</span><span style="color:#e6db74">&#39;</span>: repo_name}

                    storage_repos[repo_id][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">name</span><span style="color:#e6db74">&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{} - {}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(repo_id, repo_name)
                    storage_repos[repo_id][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">images</span><span style="color:#e6db74">&#39;</span>]<span style="color:#f92672">.</span>append({
                        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">metricTrackingObject</span><span style="color:#e6db74">&#39;</span>: metric_id,
                        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">billingItemId</span><span style="color:#e6db74">&#39;</span>: child[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">storageRepository</span><span style="color:#e6db74">&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">billingItem</span><span style="color:#e6db74">&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">id</span><span style="color:#e6db74">&#39;</span>],
                        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">rate</span><span style="color:#e6db74">&#39;</span>: rate, 
                        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">size</span><span style="color:#e6db74">&#39;</span>: size,
                        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">name</span><span style="color:#e6db74">&#39;</span>: child[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">name</span><span style="color:#e6db74">&#39;</span>],
                        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">cost</span><span style="color:#e6db74">&#39;</span>: round(size <span style="color:#f92672">*</span> rate, <span style="color:#ae81ff">2</span>)
                    })
                <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">KeyError</span> <span style="color:#66d9ef">as</span> e:
                    <span style="color:#66d9ef">pass</span>

        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Valut, Last Cost, Next Cost, Size, Images</span><span style="color:#e6db74">&#34;</span>)
        <span style="color:#66d9ef">for</span> repo <span style="color:#f92672">in</span> storage_repos:
            next_cost <span style="color:#f92672">=</span> []
            size <span style="color:#f92672">=</span> []
            images <span style="color:#f92672">=</span> []
            <span style="color:#66d9ef">for</span> image <span style="color:#f92672">in</span> storage_repos[repo][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">images</span><span style="color:#e6db74">&#39;</span>]:
                next_cost<span style="color:#f92672">.</span>append(image[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">cost</span><span style="color:#e6db74">&#39;</span>])
                size<span style="color:#f92672">.</span>append(image[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">size</span><span style="color:#e6db74">&#39;</span>])
                images<span style="color:#f92672">.</span>append(image[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">name</span><span style="color:#e6db74">&#39;</span>])

            <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}, {}, {}, {}, {}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(
                storage_repos[repo][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">name</span><span style="color:#e6db74">&#39;</span>], storage_repos[repo][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recurringFee</span><span style="color:#e6db74">&#39;</span>],
                round(sum(next_cost),<span style="color:#ae81ff">2</span>), round(sum(size),<span style="color:#ae81ff">2</span>), <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">,</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>join(images)
            ))

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lastInvoiceRepos</span>(self):
        <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">Gets the last invoice and fines all the SoftLayer_Virtual_Storage_Repository items</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
        repos <span style="color:#f92672">=</span> {}
        invoice_mask <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">mask[id]</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
        top_mask <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#e6db74">mask[category,billingItem,product]</span><span style="color:#e6db74">&#34;&#34;&#34;</span>
        <span style="color:#75715e"># Image Template Storage or Public Image Storage</span>
        <span style="color:#75715e"># Archive Storage Repository or Public Storage Repository</span>
        _filter <span style="color:#f92672">=</span> {
            <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">invoiceTopLevelItems</span><span style="color:#e6db74">&#39;</span> : {
                <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">categoryCode</span><span style="color:#e6db74">&#39;</span>: {
                    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">operation</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">or</span><span style="color:#e6db74">&#39;</span>,
                    <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">options</span><span style="color:#e6db74">&#39;</span>: [{
                        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">name</span><span style="color:#e6db74">&#39;</span>: <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">data</span><span style="color:#e6db74">&#39;</span>,
                        <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">value</span><span style="color:#e6db74">&#39;</span>: [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">public_storage</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">guest_storage</span><span style="color:#e6db74">&#39;</span>]
                    }]
                }
            }
        }

        invoice <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">SoftLayer_Account</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">getLatestRecurringInvoice</span><span style="color:#e6db74">&#39;</span>, mask<span style="color:#f92672">=</span>invoice_mask)
        items <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>call(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">SoftLayer_Billing_Invoice</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">getInvoiceTopLevelItems</span><span style="color:#e6db74">&#39;</span>, mask<span style="color:#f92672">=</span>top_mask, 
                                 filter<span style="color:#f92672">=</span>_filter, iter<span style="color:#f92672">=</span>True, id<span style="color:#f92672">=</span>invoice[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">id</span><span style="color:#e6db74">&#39;</span>])
        <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> items:
            repos[item[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">resourceTableId</span><span style="color:#e6db74">&#39;</span>]] <span style="color:#f92672">=</span> {
                <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">product</span><span style="color:#e6db74">&#39;</span>: item[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">product</span><span style="color:#e6db74">&#39;</span>][<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">description</span><span style="color:#e6db74">&#39;</span>],
                <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recurringFee</span><span style="color:#e6db74">&#39;</span> :item[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">recurringFee</span><span style="color:#e6db74">&#39;</span>],
                <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">oneTimeFee</span><span style="color:#e6db74">&#39;</span>: item[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">oneTimeFee</span><span style="color:#e6db74">&#39;</span>],
                <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">images</span><span style="color:#e6db74">&#39;</span>: [],
                <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">name</span><span style="color:#e6db74">&#39;</span>: item[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">resourceTableId</span><span style="color:#e6db74">&#39;</span>]
            }

        <span style="color:#66d9ef">return</span> repos
 

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">convert</span>(self, bytes):
        <span style="color:#66d9ef">return</span>  round(int(bytes) <span style="color:#f92672">/</span> (<span style="color:#ae81ff">1024</span> <span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#ae81ff">3</span> ),<span style="color:#ae81ff">2</span>)
 
<span style="color:#a6e22e">@click.command</span>()
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
    main <span style="color:#f92672">=</span> example()
    main<span style="color:#f92672">.</span>main()
    
    <span style="color:#75715e"># Uncomment this to print out the API calls made.</span>
    <span style="color:#75715e"># main.debug()</span>
 
<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">__main__</span><span style="color:#e6db74">&#34;</span>:
    main()
</code></pre></div>
            </div>
        </div>

    </div>
    <hr>
    <div class="row">
            
        <div class="col-md-6">
            
<div class="panel panel-default">
    <div class="panel-heading" style="padding: 2px 15px;">
        <h4>More Documentation</h4>
    </div>
    <div class="panel-body">
        <a href="https://softlayer.github.com/reference/softlayerapi"><i class="fa fa-link"></i> SoftLayer API Reference<br></a>
        <a href="https://github.com/softlayer/softlayer-java"><i class="fab fa-github"></i> softlayer-java<br></a>
        <a href="https://github.com/softlayer/softlayer-api-perl-client"><i class="fab fa-github"></i> softlayer-perl<br></a>
        <a href="https://github.com/softlayer/softlayer-api-php-client"><i class="fab fa-github"></i> softlayer-php<br></a>
        <a href="https://github.com/softlayer/softlayer-python"><i class="fab fa-github"></i> softlayer-python<br></a>
        <a href="https://github.com/softlayer/softlayer-ruby"><i class="fab fa-github"></i> softlayer-ruby<br></a>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading text-center" style="padding: 2px 15px;">
      <a href="https://www.facebook.com/IBMBluemixIaaS/"><i class="fab fa-facebook-square" alt="facebook"></i> </a>
      <a href="https://twitter.com/IBMBluemixIaaS"><i class="fab fa-twitter" alt="twitter"></i> </a>
      <a href="http://www.linkedin.com/company/softlayer-technologies-inc-" alt="linked-in"><i class="fab fa-linkedin"></i> </a>
      <a href="https://github.com/softlayer/softlayer.github.io"><i class="fab fa-github" alt="github"></i> </a>

    </div>
</div>

        </div>
        <div class="col-md-6">
            <div class="well well-sm" style="word-wrap: break-word;"> 
                <strong>Feedback? <span class="fa fa-comment"/></strong>
                    <p>
                        We would love to hear it<br>
                        <a class="" href="https://github.com/softlayer/api_examples/issues/new?title=Feedback%20for%20python%20-%20Image%20Template%20Costs&body=Feedback+regarding%3A%20https%3a%2f%2fsldn.softlayer.com%2fpython%2fimage_template_costs%2f"><span class="fa fa-github-square"/> Open an issue</a>
                    </p>
            </div>
        </div>

    </div>
        <footer>
            <div class="row">
                <hr>
                <div class="col-sm-12">
                    <p>&copy; SoftLayer 2015<br>
                    Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
                </div>
            </div>
        </footer>
</div>

    <script src="https://sldn.softlayer.com/js/jquery.js"></script>
    <script src="https://sldn.softlayer.com/js/bootstrap.js"></script>
</body>
</html>

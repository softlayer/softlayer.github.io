<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>Working with Brands - https://sldn.softlayer.com/</title>
    <link rel="canonical" href="https://sldn.softlayer.com/rest/brands/">
        <link href="https://sldn.softlayer.com/css/main.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/bootstrap.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/custom.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/monokai.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/highlight/solarized_dark.css" rel="stylesheet">

    <script src="https://sldn.softlayer.com/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://sldn.softlayer.com/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://sldn.softlayer.com/js/jquery-3.3.1.min.js"></script> 
    <script src="https://sldn.softlayer.com/js/sldn.js"></script>


    <link href="https://sldn.softlayer.com/fontawesome/css/fontawesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/brands.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/solid.min.css" rel="stylesheet" type="text/css">
    
    <script defer src="https://sldn.softlayer.com/fontawesome/js/solid.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/brands.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/fontawesome.min.js"></script>

    <script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
		})
	</script>
   
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9XPZ9ZBSJE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-9XPZ9ZBSJE');
</script>
</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://sldn.softlayer.com/">SoftLayer API</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                        <li><a href="https://sldn.softlayer.com/article/">Articles</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/reference/softlayerapi">Documentation</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/go/">Go</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/java/">Java</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/perl/">Perl</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/php/">PHP</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/python/">Python</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/rest/">Rest</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/ruby/">Ruby</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/tools/">Tools</a></li>
                    

                    
                </ul>
                <div id="custom-search-input" class="pull-right">
                  <form class="navbar-form" role="search" method="get" action="https://www.bing.com/search">
                    <div class="input-group col-md-12">
                      <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                      <input type="hidden" name="q1" value="site:sldn.softlayer.com" />
                      <div class="input-group-btn">
                        <button class="btn btn-info" type="submit">
                          <i class="glyphicon glyphicon-search"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>July 23, 2020<br></h4>
            </div>
        </div>
        <div class="col-md-9">

                <strong>Classes <span class="fa fa-book"/></strong>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Brand">SoftLayer_Brand</a>
                
                    <a class="label label-primary" href="https://sldn.softlayer.com/reference/services/SoftLayer_Billing_Invoice">SoftLayer_Billing_Invoice</a>
                
                <br>
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/brand">brand</a>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/bap">bap</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
		<div class="col-md-12">
            <div class="well well-sm  article" style="word-wrap: break-word;">
                <div class="article-title">
				    <h1>Working with Brands</h1>
                    <small>Details on how to work with a Brand account.</small>
                </div>
				
                
				
                <p>A Brand account is a special type of account at SoftLayer that allows the owner to manage sub-accounts. These sub accounts are separate and individual like any other SoftLayer account, with the exception being that the Brand Master account has access to them.</p>
<p>For these examples, all API calls will be made by a user under the brand master account.</p>
<h2 id="owned-brands">Owned Brands</h2>
<p>To use the <a href="https://sldn.softlayer.com/reference/services/SoftLayer_Brand">SoftLayer_Brand</a> you first need to find out the BrandId that the account owns. This can be done with the <a href="https://sldn.softlayer.com/reference/services/SoftLayer_Account/getOwnedBrands/">SoftLayer_Account::getOwnedBrands()</a> API call.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -s -u <span class="nv">$SL_BAP_USER</span>:<span class="nv">$SL_BAP_KEY</span> <span class="s1">&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Account/getOwnedBrands&#39;</span> <span class="p">|</span>  python -m json.tool
</span></span><span class="line"><span class="cl"><span class="o">[</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;catalogId&#34;</span>: 14,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;id&#34;</span>: 16762,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;keyName&#34;</span>: <span class="s2">&#34;SLD_SL_DIST_DEMO_VAR01&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;longName&#34;</span>: <span class="s2">&#34;SoftLayer Distributor Demo - VAR 01&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;name&#34;</span>: <span class="s2">&#34;SoftLayer Distributor Demo - VAR 01&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">]</span>
</span></span></code></pre></div><h2 id="owned-accounts">Owned Accounts</h2>
<p>Now that we have a brandId (16762 in the above example), we can use the Brand service to get our owned accounts with <a href="https://sldn.softlayer.com/reference/services/SoftLayer_Brand/getOwnedAccounts/">SoftLayer_Brand::getOwnedAccounts()</a></p>
<blockquote>
<p>-g in the curl command lets you use un-escaped brackets</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -g -s -u <span class="nv">$SL_BAP_USER</span>:<span class="nv">$SL_BAP_KEY</span> <span class="s1">&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Brand/16762/getOwnedAccounts?objectMask=mask[id,companyName,createDate]&#39;</span> <span class="p">|</span>  python -m json.tool
</span></span><span class="line"><span class="cl"><span class="o">[</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;companyName&#34;</span>: <span class="s2">&#34;SoftLayer Distributor Demo - VAR 01 - Child Account&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;createDate&#34;</span>: <span class="s2">&#34;2014-06-11T11:40:18-05:00&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;id&#34;</span>: <span class="m">345582</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;companyName&#34;</span>: <span class="s2">&#34;Partner Ecosystem Test &#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;createDate&#34;</span>: <span class="s2">&#34;2020-05-19T11:07:37-05:00&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;id&#34;</span>: <span class="m">2088582</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">]</span>
</span></span></code></pre></div><h2 id="current-useage-by-account">Current Useage by Account</h2>
<p>To see what your accounts are currently using and being billed for, we need to look at each accounts <a href="https://sldn.softlayer.com/reference/datatypes/SoftLayer_Account/#nextinvoicetoplevelbillingitems">nextInvoiceTopLevelBillingItems</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -g -s -u <span class="nv">$SL_BAP_USER</span>:<span class="nv">$SL_BAP_KEY</span> <span class="s1">&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Brand/16762/getOwnedAccounts?objectMask=mask[id,companyName,createDate,nextInvoiceTopLevelBillingItems]&amp;resultLimit=0,1&#39;</span> <span class="p">|</span>  python -m json.tool         
</span></span><span class="line"><span class="cl"><span class="o">[</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;companyName&#34;</span>: <span class="s2">&#34;SoftLayer Distributor Demo - VAR 01 - Child Account&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;createDate&#34;</span>: <span class="s2">&#34;2014-06-11T11:40:18-05:00&#34;</span>,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;id&#34;</span>: 345582,
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;nextInvoiceTopLevelBillingItems&#34;</span>: <span class="o">[</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;categoryCode&#34;</span>: <span class="s2">&#34;hub&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;createDate&#34;</span>: <span class="s2">&#34;2014-06-13T08:29:04-05:00&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;cycleStartDate&#34;</span>: <span class="s2">&#34;2020-07-11T00:51:36-05:00&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;description&#34;</span>: <span class="s2">&#34;Object Storage - Pay as you go&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;id&#34;</span>: 28184354,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;lastBillDate&#34;</span>: <span class="s2">&#34;2020-07-11T00:51:36-05:00&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;modifyDate&#34;</span>: <span class="s2">&#34;2020-07-11T00:51:36-05:00&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;nextBillDate&#34;</span>: <span class="s2">&#34;2020-08-11T00:00:00-05:00&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;orderItemId&#34;</span>: 36760662,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;parentId&#34;</span>: null,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;recurringFee&#34;</span>: <span class="s2">&#34;0&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;recurringFeeTaxRate&#34;</span>: <span class="s2">&#34;0&#34;</span>,
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;recurringMonths&#34;</span>: 1,
</span></span><span class="line"><span class="cl">            <span class="o">}</span>,
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">]</span>
</span></span></code></pre></div><p>There may be quite a lot of these items, so it is a good idea to use a <a href="https://sldn.softlayer.com/article/using-result-limits-softlayer-api/">resultLimit</a> to page through the accounts. It is also a good idea to use a restrictive <a href="https://sldn.softlayer.com/article/object-masks/">objectMask</a>, and only select the fields you need access to.</p>
<blockquote>
<p>Selecting a local property of in an objectMask will deselect all the default properties not in the object mask for that level. In this example id,companyName,createDate are local to the Account datatype, but since no properties were defined in nextInvoiceTopLevelBillingItems, all the defaults are returned.</p>
</blockquote>
<h2 id="getting-invoices">Getting Invoices</h2>
<p>Invoices can contain a lot of data, so it is best to use the <code>Brand</code> service to get some basic information about the invoice (<code>id</code> and <code>createDate</code> specifically) and then use the <code>Billing_Invoice</code> service to get further information about the items on each invoice.</p>
<ul>
<li><a href="https://sldn.softlayer.com/reference/datatypes/SoftLayer_Account/#latestrecurringinvoice">latestRecurringInvoice</a> is used to get the accounts most current invoice.</li>
<li><a href="https://sldn.softlayer.com/reference/datatypes/SoftLayer_Account/#latestrecurringpendinginvoice">latestRecurringPendingInvoice</a> is used to get the accounts most current invoice that is NOT closed. Invoices are usually closed once the balance has been paid.</li>
<li><a href="https://sldn.softlayer.com/datatypes/SoftLayer_Account/#invoices">invoices</a> will list ALL of the accounts invoices</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -g -s -u <span class="nv">$SL_BAP_USER</span>:<span class="nv">$SL_BAP_KEY</span> <span class="s1">&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Brand/16762/getOwnedAccounts?objectMask=mask[id,companyName,createDate,latestRecurringInvoice]&amp;resultLimit=0,2&#39;</span> <span class="p">|</span>  python -m json.tool 
</span></span></code></pre></div><h3 id="the-invoice">The Invoice</h3>
<p><a href="https://sldn.softlayer.com/article/billing/">Billing and Invoices</a> goes into detail on how invoices work at SoftLayer, and should be very helpful.</p>
<p>Once you have the invoice id, you will likely be most concerned with the <a href="https://sldn.softlayer.com/reference/services/SoftLayer_Billing_Invoice/getInvoiceTopLevelItems/">invoiceTopLevelItems</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -g -s -u <span class="nv">$SL_BAP_USER</span>:<span class="nv">$SL_BAP_KEY</span> <span class="s1">&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Billing_Invoice/56409210/getInvoiceTopLevelItems?objectMask=mask[children,invoice[id]]&amp;resultLimit=0,200&#39;</span> <span class="p">|</span> python -m json.tool
</span></span></code></pre></div><blockquote>
<p>the invoice[id] is included in the mask otherwise the whole invoice data will be included in each of the children, generating a lot of returned data. Selecting other local properties from either invoiceTopLevelItems or children would also work.</p>
</blockquote>
<h3 id="filtering-invoice-items">Filtering Invoice Items</h3>
<p>Each invoice will contain items from the cloud.ibm.com portal, which you may or may not want to parse through. To filter those out, use the following <a href="https://sldn.softlayer.com/article/object-filters/">objectFilter</a></p>
<p>This will limit the items returned to only those that are not in the paas categories.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -g -s -u <span class="nv">$SL_BAP_USER</span>:<span class="nv">$SL_BAP_KEY</span> <span class="s1">&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Billing_Invoice/56409210/getInvoiceTopLevelItems?objectMask=mask[invoice[id]]&amp;objectFilter={&#34;invoiceTopLevelItems&#34;:{&#34;categoryCode&#34;:{&#34;operation&#34;:&#34;!^=paas_&#34;}}}&amp;resultLimit=0,200&#39;</span>  <span class="p">|</span> python -m json.tool
</span></span></code></pre></div><h3 id="filtering-invoices-on-a-date-range">Filtering Invoices on a date range</h3>
<p>You may want to only get invoices in a certain date range, which is possible with a <code>filteredMask</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -g -s -u <span class="nv">$SL_BAP_USER</span>:<span class="nv">$SL_BAP_KEY</span> <span class="err">&#39;</span>https://api.softlayer.com/rest/v3.1/SoftLayer_Account/OwnedBrands?objectMask<span class="o">=</span>filteredMask.allOwnedAccounts<span class="o">[</span>id,accountStatusId,invoices<span class="o">[</span>invoiceTotalAmount<span class="o">]]</span><span class="p">&amp;</span><span class="nv">objectFilter</span><span class="o">={</span><span class="s2">&#34;ownedBrands&#34;</span>:<span class="o">{</span><span class="s2">&#34;allOwnedAccounts&#34;</span>:<span class="o">{</span><span class="s2">&#34;invoices&#34;</span>:<span class="o">{</span><span class="s2">&#34;createDate&#34;</span>:<span class="o">{</span><span class="s2">&#34;operation&#34;</span>:<span class="s2">&#34;betweenDate&#34;</span>,<span class="s2">&#34;options&#34;</span>:<span class="o">[{</span><span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;startDate&#34;</span>,<span class="s2">&#34;value&#34;</span>:<span class="o">[</span><span class="s2">&#34;06/01/2020&#34;</span><span class="o">]}</span>,<span class="o">{</span><span class="s2">&#34;name&#34;</span>:<span class="s2">&#34;endDate&#34;</span>,<span class="s2">&#34;value&#34;</span>:<span class="o">[</span><span class="s2">&#34;07/15/2020 23:59:59&#34;</span><span class="o">]}]}}}}}</span>
</span></span></code></pre></div><p>or for a specific brand&rsquo;s accounts</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -g -s -u <span class="nv">$SL_BAP_USER</span>:<span class="nv">$SL_BAP_KEY</span> <span class="s1">&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Brand/16762/getOwnedAccounts?objectMask=filteredMask[id,accountStatusId,invoices[id,createDate,invoiceTotalAmount]]&amp;objectFilter={&#34;ownedAccounts&#34;:{&#34;invoices&#34;:{&#34;createDate&#34;:{&#34;operation&#34;:&#34;betweenDate&#34;,&#34;options&#34;:[{&#34;name&#34;:&#34;startDate&#34;,&#34;value&#34;:[&#34;07/01/2020&#34;]},{&#34;name&#34;:&#34;endDate&#34;,&#34;value&#34;:[&#34;07/15/2020&#34;]}]}}}}&#39;</span> <span class="p">|</span> python -m json.tool
</span></span></code></pre></div><h2 id="sub-account-master-users">Sub-Account Master Users</h2>
<p>Sometimes as a brand account, it can be easier to use the API as a &ldquo;normal&rdquo; user. For this it is easy enough to get the master user of each sub-account and its API key, and make API calls that way.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl -g -s -u <span class="nv">$SL_BAP_USER</span>:<span class="nv">$SL_BAP_KEY</span> <span class="s1">&#39;https://api.softlayer.com/rest/v3.1/SoftLayer_Brand/16762/getOwnedAccounts?objectMask=mask[id,companyName,createDate,masterUser[id,username,apiAuthenticationKeys[authenticationKey]]]&amp;resultLimit=0,2&#39;</span> <span class="p">|</span>  python -m json.tool 
</span></span></code></pre></div><p>While it is not required, I recommend retaining control over the master account for each sub-account, and creating new user accounts for any other users.</p>

            </div>
        </div>

    </div>
    <hr>
    <div class="row">
        <div class="row">
            <div class="col-md-6">
    <div class="well well-sm" style="word-wrap: break-word;"> 
        <strong>Feedback? <span class="fas fa-comment"/></strong>
            <p>
                If this article contains any error, or leaves any of your questions unanswered, please help us out by 
                opening up a github issue.<br>
                <a class="" href="https://github.com/softlayer/githubio_source/issues/new?title=Feedback%20for%20rest%20-%20Working%20with%20Brands&body=Feedback+regarding%3A%20https%3a%2f%2fsldn.softlayer.com%2frest%2fbrands%2f"> Open an issue</a>
                <i class="fab fa-github" alt="github"></i>
            </p>
    </div>
</div>
        </div>
    </div>
<footer>
    <div class="row">
        <div class="col-sm-12">
            <p>&copy; SoftLayer 2022<br>
            Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
        </div>
    </div>
</footer>
</div>

    <script src="https://sldn.softlayer.com/js/jquery.js"></script>
    <script src="https://sldn.softlayer.com/js/bootstrap.js"></script>
</body>
</html>

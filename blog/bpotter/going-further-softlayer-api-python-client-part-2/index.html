<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>Going Further with the SoftLayer API Python Client - Part 2 - https://sldn.softlayer.com/</title>
    <link rel="canonical" href="https://sldn.softlayer.com/blog/bpotter/going-further-softlayer-api-python-client-part-2/">
        <link href="https://sldn.softlayer.com/css/main.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/bootstrap.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/fa-svg-with-js.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/custom.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/highlight/solarized_dark.css" rel="stylesheet">

    <script src="https://sldn.softlayer.com/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://sldn.softlayer.com/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://sldn.softlayer.com/js/jquery-3.3.1.min.js"></script> 
    <script src="https://sldn.softlayer.com/js/sldn.js"></script>
    <script src="https://sldn.softlayer.com/js/fontawesome-all.js"></script>

    <script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
		})
	</script>
    
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-88235803-1', 'auto');
ga('send', 'pageview');
</script>

</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://sldn.softlayer.com/">SoftLayer API</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                        <li><a href="https://sldn.softlayer.com/article/">Articles</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/reference/softlayerapi">Documentation</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/go/">Go</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/java/">Java</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/perl/">Perl</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/python/">Python</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/rest/">Rest</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/ruby/">Ruby</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/tools/">Tools</a></li>
                    

                    
                </ul>
                <div id="custom-search-input" class="pull-right">
                  <form class="navbar-form" role="search" method="get" action="https://www.bing.com/">
                    <div class="input-group col-md-12">
                      <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                      <input type="hidden" name="q1" value="site:softlayer.github.io" />
                      <div class="input-group-btn">
                        <button class="btn btn-info" type="submit">
                          <i class="glyphicon glyphicon-search"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>February 13, 2015<br></h4>
            </div>
        </div>
        <div class="col-md-9">

                <strong>Classes <span class="fa fa-book"/></strong>
                
                <br>
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/blog">blog</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
		<div class="col-md-12">
            <div class="well well-sm release-note" style="word-wrap: break-word;">
				<h3>Going Further with the SoftLayer API Python Client - Part 2<br> <small>&lt;p&gt;In my previous &lt;a href=http://sldn.softlayer.com/blog/bpotter/Going-Further-SoftLayer-API-Python-Client-Part-1&gt;blog</small></h3>
				
                
				
                

<p>In my previous <a href="http://sldn.softlayer.com/blog/bpotter/Going-Further-SoftLayer-API-Python-Client-Part-1">blog post</a>, I covered how to navigate the <a href="http://sldn.softlayer.com/reference/services/SoftLayer_Account">SoftLayer Services</a> website, and how to query the SoftLayer API efficiently. In this post, I'll cover additional aspects of using the SoftLayer API with the python client. 
</p>

<h2>List of Services to Start Navigating From</h2>

<p><p>If you read <a href="http://sldn.softlayer.com/blog/bpotter/Going-Further-SoftLayer-API-Python-Client-Part-1">part 1</a> of the series, you have a lot of good techniques for querying the data of resources in SoftLayer such that from any service you can efficiently follow the data trail to other services to get to all of the information you want. The last big thing you need to know about querying the SoftLayer API is: Where are the best places in the enormous SoftLayer Services website to begin these trails? The Account service is a good place to start for many data types, but always starting there will not get you to everything. Even if you can eventually get to the data you want by starting with the Account service, there are often shortcuts to be found by starting somewhere else. I&rsquo;ve put together a list of useful trail heads and what data types can be found down each trail. This is by no means an exhaustive list, but will hopefully get you started.
  </p></p>

<p><ul>
  <li><a href="http://sldn.softlayer.com/reference/services/SoftLayer_Account">Account</a>
    <ul>
    <li>getNetworkVlans(): returns the network VLANs in the account, which can also get you to the subnets and primaryRouters
    <li>getHardware(): returns hardware, which gets you to datacenter, hardDrives, processors, memory, networkCards, operatingSystem which gets you to
passwords
    <li>getVirtualGuests(): returns Virtual_Guest, which gets you to maxCpu, maxMemory, datacenter, operatingSystem
    <li>getCurrentUser(): returns User_Customer, which gets you to childUsers and permissions
    <li>getUsers(): returns all of the users in this account
    <li>getNetworkGateways(): returns the gateways (Vyattas), which gets you to the networkVlans associated to (routed by) the gateway, and then the subnets and primaryRouters
    <li>getTickets(): returns the tickets associated with an account
    <li>getOrders(): returns the orders for this account
    </ul>
  <li><a href="http://sldn.softlayer.com/reference/services/SoftLayer_Location">Location</a>
    <ul>
    <li>getDatacenters(): returns datacenters, which can get you to routers, etc.
    </ul>
  <li><a href="http://sldn.softlayer.com/reference/services/SoftLayer_Product_Package">Product_Package</a>
    <ul>
    <li>getAllObjects(): returns the products that can be ordered
    <li>getConfiguration(): returns the categories of items (parts) of a product that can be specified when ordering it
    <li>getItemPrices(): returns the various parts of a product that can be specified when ordering it
    </ul>
  <li><a href="http://sldn.softlayer.com/reference/services/SoftLayer_Billing_Order">Billing_Order</a>
    <ul>
    <li>getOrderStatuses(): returns the status for all orders of this account
    </ul>
  <li><a href="http://sldn.softlayer.com/reference/services/SoftLayer_User_Customer">User_Customer</a>
    <ul>
    <li>getChildUsers(): returns the users that are children of (i.e., created by) the current user
    </ul>
  </ul></p>

<h2>Services That Modify SoftLayer Resources</h2>

<p><p>Now that you are an expert at <strong>querying</strong> the SoftLayer API, let&rsquo;s move on to SoftLayer API calls that <strong>modify</strong> SoftLayer resources. The basics are similar: Find the right service and method within that service, fill out a data structure similar to what it would be like if you queried it, and if this is an existing resource, use the id to identify it. There are <strong>many</strong> SoftLayer API methods that modify resources, but to give you a feel for what they are like, I&rsquo;ll list a few and then give you a detailed example of one.
  </p></p>

<p><ul>
  <li><a href="http://sldn.softlayer.com/reference/services/SoftLayer_Hardware">Hardware</a>
    <ul>
    <li>editSoftwareComponentPasswords(): notifies SoftLayer that you changed the password of a CCI or bare metal server so it will display correctly in the SoftLayer portal and so SoftLayer support can access the CCI when you have a problem
    </ul>
  <li><a href="http://sldn.softlayer.com/reference/services/SoftLayer_Network_Gateway">Network_Gateway</a>
    <ul>
    <li>bypassVlans(): change a VLAN that is associated to a gateway from routed state to bypassed state
    <li>unbypassVlans(): change a VLAN that is associated to a gateway from bypassed state to routed state
    </ul>
  <li><a href="http://sldn.softlayer.com/reference/services/SoftLayer_Network_Gateway_Vlan">Network_Gateway_Vlan</a>
    <ul>
    <li>createObjects(): associate VLANs to this gateway (i.e., have the gateway be the router for them)
    <li>deleteObjects(): disassociate VLANs from this gateway
    </ul>
  <li><a href="http://sldn.softlayer.com/reference/services/SoftLayer_Product_Order">Product_Order</a>
    <ul>
    <li>placeOrder(): order a resource from SoftLayer
    <li>verifyOrder(): verify that your order data structure is valid, but don&rsquo;t actually order the resource
    </ul>
  <li><a href="http://sldn.softlayer.com/reference/services/SoftLayer_Billing_Item">Billing_Item</a>
    <ul>
    <li>cancelItem(): give a resource back to SoftLayer (for monthly items, they are still usable until the end of the month)
    </ul>
  </ul></p>

<p><p>For our detailed example, we will associate VLANs to a network gateway. On the SoftLayer Services website, we find that the <a href="http://sldn.softlayer.com/reference/services/SoftLayer_Network_Gateway_Vlan">Network_Gateway_Vlan</a> service has a method called <a href="http://sldn.softlayer.com/reference/services/SoftLayer_Network_Gateway_Vlan/createObjects">createObjects</a> that will associate VLANs to a gateway. We see that the argument the method takes is an array of <a href="http://sldn.softlayer.com/reference/datatypes/SoftLayer_Network_Gateway_Vlan">Network_Gateway_Vlan</a> data type objects.
  So this example will:
  </p></p>

<p><ul>
  <li>Get the id of the gateway we want to associate the VLANs to
  <li>Get id values of the VLANs to be associated with the gateway
  <li>Build an array of Network_Gateway_Vlan objects; filling in the local properties of that data type
  <li>Call Network_Gateway_Vlan.createObjects(); giving it that array
  </ul></p>

<p><code>
import SoftLayer
import pprint</p>

<h1 id="get-the-softlayer-api-client-object">Get the SoftLayer API client object</h1>

<p>client = SoftLayer.Client(username=myuser, api_key=mykey, endpoint_url=SoftLayer.API_PUBLIC_ENDPOINT)</p>

<h1 id="get-the-id-of-the-gateway-you-want-to-associate-the-vlans-to">Get the id of the gateway you want to associate the VLANs to</h1>

<p>gateways = client[&lsquo;Account&rsquo;].getNetworkGateways(mask=&lsquo;id, name&rsquo;, filter={&lsquo;networkGateways&rsquo;: {&lsquo;name&rsquo;: {&lsquo;operation&rsquo;: &lsquo;v1&rsquo;}}})
gatewayid = gateways[0][&lsquo;id&rsquo;]</p>

<h1 id="get-all-of-the-vlans-that-are-allowed-to-be-associated-with-this-gateway">Get all of the VLANs that are allowed to be associated with this gateway.</h1>

<h1 id="for-this-example-we-assume-we-want-to-associate-all-of-them">For this example, we assume we want to associate all of them.</h1>

<p>vlans = client[&lsquo;Network_Gateway&rsquo;].getPossibleInsideVlans(id=gatewayid, mask=&lsquo;id, vlanNumber&rsquo;)</p>

<h1 id="build-the-array-of-network-gateway-vlan-objects">Build the array of Network_Gateway_Vlan objects.</h1>

<h1 id="it-s-local-properties-are-bypassflag-id-networkgatewayid-networkvlanid">It&rsquo;s local properties are: bypassFlag, id, networkGatewayId, networkVlanId.</h1>

<p>objs = []
for v in vlans:
    # Fill in the object properties. We set id to None, because SoftLayer will fill that in when the
    # objects are created.
    objs.append({&lsquo;bypassFlag&rsquo;:True, &lsquo;id&rsquo;:None, &lsquo;networkGatewayId&rsquo;:gatewayid, &lsquo;networkVlanId&rsquo;:v[&lsquo;id&rsquo;]})</p>

<h1 id="use-the-network-gateway-vlan-service-to-associate-them">Use the Network_Gateway_Vlan service to associate them</h1>

<p>assocVlans = client[&lsquo;Network_Gateway_Vlan&rsquo;].createObjects(objs)</p>

<h1 id="the-output-is-the-created-network-gateway-vlan-objects">the output is the created Network_Gateway_Vlan objects</h1>

<p>pprint.pprint(assocVlans)</code></p>

<h2>SoftLayer Exceptions</h2>

<p>You probably noticed that none of the example code had error checking. That's because I was waiting to cover SoftLayer exceptions here. The main SoftLayer API exception class is SoftLayer.exceptions.SoftLayerAPIError, and it has two members: faultCode and faultString. You can catch API errors like this:</p>

<p><code>import SoftLayer</p>

<h1 id="get-the-softlayer-api-client-object-1">Get the SoftLayer API client object</h1>

<p>client = SoftLayer.Client(username=myuser, api_key=mykey, endpoint_url=SoftLayer.API_PUBLIC_ENDPOINT)</p>

<p>try:
    # A sample API call
    gatewayid = 1      # an id that does not exist
    gw = client[&lsquo;Network_Gateway&rsquo;].getObject(id=gatewayid, mask=&lsquo;id&rsquo;)
except SoftLayer.exceptions.SoftLayerAPIError as e:
    print &lsquo;SoftLayer exception occurred: &lsquo; + str(e.faultCode) + &lsquo;: &lsquo; + e.faultString</code></p>

<p><p>You can see some of the common faultStrings at the bottom of <a href="http://sldn.softlayer.com/article/Exception-Handling-SoftLayer-API">http://sldn.softlayer.com/article/Exception-Handling-SoftLayer-API</a> in case you want to handle some of them individually in the &ldquo;except&rdquo; section of your code.
  </p></p>

<p>In my next blog post I'll cover in detail how to order SoftLayer resources using the API.</p>

            </div>
        </div>

    </div>
    <hr>
    <div class="row">
            
        <div class="col-md-6">
            
<div class="panel panel-default">
    <div class="panel-heading" style="padding: 2px 15px;">
        <h4>More Documentation</h4>
    </div>
    <div class="panel-body">
        <a href="https://softlayer.github.com/reference/softlayerapi"><i class="fa fa-link"></i> SoftLayer API Reference<br></a>
        <a href="https://github.com/softlayer/softlayer-java"><i class="fab fa-github"></i> softlayer-java<br></a>
        <a href="https://github.com/softlayer/softlayer-api-perl-client"><i class="fab fa-github"></i> softlayer-perl<br></a>
        <a href="https://github.com/softlayer/softlayer-api-php-client"><i class="fab fa-github"></i> softlayer-php<br></a>
        <a href="https://github.com/softlayer/softlayer-python"><i class="fab fa-github"></i> softlayer-python<br></a>
        <a href="https://github.com/softlayer/softlayer-ruby"><i class="fab fa-github"></i> softlayer-ruby<br></a>
    </div>
</div>

<div class="panel panel-default">
    <div class="panel-heading text-center" style="padding: 2px 15px;">
      <a href="https://www.facebook.com/IBMBluemixIaaS/"><i class="fab fa-facebook-square" alt="facebook"></i> </a>
      <a href="https://twitter.com/IBMBluemixIaaS"><i class="fab fa-twitter" alt="twitter"></i> </a>
      <a href="http://www.linkedin.com/company/softlayer-technologies-inc-" alt="linked-in"><i class="fab fa-linkedin"></i> </a>
      <a href="https://github.com/softlayer/softlayer.github.io"><i class="fab fa-github" alt="github"></i> </a>

    </div>
</div>

        </div>
        <div class="col-md-6">
            <div class="well well-sm" style="word-wrap: break-word;"> 
                <strong>Feedback? <span class="fa fa-comment"/></strong>
                    <p>
                        We would love to hear it<br>
                        <a class="" href="https://github.com/softlayer/api_examples/issues/new?title=Feedback%20for%20blog%20-%20Going%20Further%20with%20the%20SoftLayer%20API%20Python%20Client%20-%20Part%202&body=Feedback+regarding%3A%20https%3a%2f%2fsldn.softlayer.com%2fblog%2fbpotter%2fgoing-further-softlayer-api-python-client-part-2%2f"><span class="fa fa-github-square"/> Open an issue</a>
                    </p>
            </div>
        </div>

    </div>
        <footer>
            <div class="row">
                <hr>
                <div class="col-sm-12">
                    <p>&copy; SoftLayer 2015<br>
                    Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
                </div>
            </div>
        </footer>
</div>

    <script src="https://sldn.softlayer.com/js/jquery.js"></script>
    <script src="https://sldn.softlayer.com/js/bootstrap.js"></script>
</body>
</html>

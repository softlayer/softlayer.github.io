<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>Object Masks and Filters in C Sharp - https://sldn.softlayer.com/</title>
    <link rel="canonical" href="https://sldn.softlayer.com/blog/wfrancis/object-masks-and-filters-c-sharp/">
        <link href="https://sldn.softlayer.com/css/main.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/bootstrap.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/custom.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/monokai.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/highlight/solarized_dark.css" rel="stylesheet">

    <script src="https://sldn.softlayer.com/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://sldn.softlayer.com/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://sldn.softlayer.com/js/jquery-3.3.1.min.js"></script> 
    <script src="https://sldn.softlayer.com/js/sldn.js"></script>


    <link href="https://sldn.softlayer.com/fontawesome/css/fontawesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/brands.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/solid.min.css" rel="stylesheet" type="text/css">
    
    <script defer src="https://sldn.softlayer.com/fontawesome/js/solid.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/brands.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/fontawesome.min.js"></script>

    <script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
		})
	</script>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9XPZ9ZBSJE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-9XPZ9ZBSJE', { 'anonymize_ip': false });
}
</script>

</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://sldn.softlayer.com/">SoftLayer API</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                        <li><a href="https://sldn.softlayer.com/article/">Articles</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/reference/softlayerapi">Documentation</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/go/">Go</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/java/">Java</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/perl/">Perl</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/php/">PHP</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/python/">Python</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/rest/">Rest</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/ruby/">Ruby</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/tools/">Tools</a></li>
                    

                    
                </ul>
                <div id="custom-search-input" class="pull-right">
                  <form class="navbar-form" role="search" method="get" action="https://www.bing.com/search">
                    <div class="input-group col-md-12">
                      <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                      <input type="hidden" name="q1" value="site:sldn.softlayer.com" />
                      <div class="input-group-btn">
                        <button class="btn btn-info" type="submit">
                          <i class="glyphicon glyphicon-search"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>February 19, 2010<br></h4>
            </div>
        </div>
        <div class="col-md-9">

                <strong>Classes <span class="fa fa-book"/></strong>
                
                <br>
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/blog">blog</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
		<div class="col-md-12">
            <div class="well well-sm  article" style="word-wrap: break-word;">
                <div class="article-title">
				    <h1>Object Masks and Filters in C Sharp</h1>
                    <small>&lt;p&gt;&lt;strong&gt;Object Masks, Filters, and Other V3 Black Magic&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Everyone has heard the age old saying for an</small>
                </div>
				
                
				
                <p><strong>Object Masks, Filters, and Other V3 Black Magic</strong></p>
<p>Everyone has heard the age old saying for any given job you need to have the right tool. Just as most of us have tried to use the flat rounded edge of a butter knife a time or two when what we desperately needed was a screw driver. Does that mean you weren't able to open that little compartment on whatever gizmo and replace the batteries? Probably not. In most cases it is possible to use a butter knife when a screw driver is the tool of choice; it's just more painful and a lot less effective.</p>
<p>The same can said of the <a href="http://sldn.softlayer.com/wiki/index.php/The_SoftLayer_API">SoftLayer API</a> (SLAPI). It's a toolset. A very flexible set of tools allowing a developer to manage every aspect of dedicated hosting from accounting and billing to physical status of remote hardware. And yet there are so many tools in the V3 API toolbox, a number of them only subtlety different from their binary brethren ( at least on the surface), it's tempting just to reach your hand into the bag, find the first thing that resembles a screw driver, and begin turning.</p>
<p>I know. I'm speaking from my own experiences. As a developer who largely works on SoftLayer's back end systems, somewhere between the bottom of TCP/IP stack and the top edge of the kernel, recently getting to do production user portal code was a new experience for me. Sure I wrote some demos, dabbled a little here and there, but when I started doing my first "real" V3/SLAPI intensive project I realized my prior attempts had entirely missed the true power and elegance of SLAPI. The magic if you will. A little something called ORM.</p>
<p>Those of you who spend your days toiling in the world or relational databases are probably fairly familiar with the term ORM. But for someone like me who usually comes no closer to a database than reading an I/O address from the Windows registry, I was only vaguely aware of what the acronym even stood for. I turned to Webopedia. There I discovered the following. "Short for object role modeling, ORM is a conceptual database design methodology that allows the user to express information as an object and explore how it relates to other information objects".</p>
<p>So there we have it. Database. Objects. Relations. I learn hands on—so none of that amounts to a hill of beans without some real code I can see and type and run for myself. So rather than regurgitate the SLDN documentation, I will just share a simple yet real life example. Then, in the second part of the article, we can expand that example to show some of the more powerful and less documented features of the V3 SLAPI.</p>
<p>The code that follows is written in Microsoft C Sharp using Visual Studio 2008 Professional Edition. I am not going to step through the basics of connecting a WSDL and generating a SOAP wrapper in this article. If you need help with that, there is an SLDN blog I did a while back which covers those steps entitled, "Dot Net? You Bet!". It is still available under the implementations section of the SLDN website. True to my MO, I am not a big GUI guy so the code I am presenting runs as a Windows console application.</p>
<p>For the sake of making the example clear, I am going to simplify my task. In the example in both this article, and the next in the series, we will be playing the role of a developer who needs to count how many of his or her servers are running the Microsoft Windows operating system, as opposed to one of the many Linux variants SoftLayer also offers its customers. For our first code sample, we require two WSDLs: the <a href="http://sldn.softlayer.com/wiki/index.php/SoftLayer_Account">SoftLayer_Account</a> service as well as the <a href="http://sldn.softlayer.com/wiki/index.php/SoftLayer_Hardware_Server">SoftLayer_Hardware_Server</a> service. The console program below will get us connected to the SoftLayer application servers, as well as provide us some timing metrics.</p>
<div class="geshifilter">
<pre class="csharp geshifilter-csharp" style="font-family:monospace;"><span style="color: #0600FF;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Collections.Generic</span><span style="color: #008000;">;</span>
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Linq</span><span style="color: #008000;">;</span> 
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Text</span><span style="color: #008000;">;</span>
&nbsp;
<span style="color: #0600FF;">namespace</span> SLDN_Magic
<span style="color: #000000;">&#123;</span>
   <span style="color: #FF0000;">class</span> Program
   <span style="color: #000000;">&#123;</span>
       <span style="color: #0600FF;">static</span> <span style="color: #0600FF;">void</span> Main<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">string</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> args<span style="color: #000000;">&#41;</span>
       <span style="color: #000000;">&#123;</span>
           <span style="color: #008080; font-style: italic;">//global timing vars</span>
           DateTime stopwatch<span style="color: #008000;">;</span>
           TimeSpan elapsed<span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//replace with your username and api key</span>
           <span style="color: #FF0000;">string</span> user_name <span style="color: #008000;">=</span> <span style="color: #666666;">"Replace With Your User Name"</span><span style="color: #008000;">;</span>
           <span style="color: #FF0000;">string</span> api_key <span style="color: #008000;">=</span> <span style="color: #666666;">"Replace With Your API Key"</span><span style="color: #008000;">;</span>
&nbsp;
           Console.<span style="color: #0000FF;">Write</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Establishing connection to SLDN service..."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//time it</span>
           stopwatch <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span><span style="color: #008000;">;</span>
           <span style="color: #008080; font-style: italic;">//declare the services</span>
           SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_AccountService</span> acct <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_AccountService</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           SLDN_SVR.<span style="color: #0000FF;">SoftLayer_Hardware_ServerService</span> svr <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_SVR.<span style="color: #0000FF;">SoftLayer_Hardware_ServerService</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span> 
&nbsp;
           <span style="color: #008080; font-style: italic;">//create an authentification object for each</span>
           SLDN_ACCT.<span style="color: #0000FF;">authenticate</span> credentials_a <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">authenticate</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           SLDN_SVR.<span style="color: #0000FF;">authenticate</span> credentials_b <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_SVR.<span style="color: #0000FF;">authenticate</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//assign credentials</span>
           credentials_a.<span style="color: #0000FF;">username</span> <span style="color: #008000;">=</span> credentials_b.<span style="color: #0000FF;">username</span> <span style="color: #008000;">=</span> user_name<span style="color: #008000;">;</span>
           credentials_a.<span style="color: #0000FF;">apiKey</span> <span style="color: #008000;">=</span> credentials_b.<span style="color: #0000FF;">apiKey</span> <span style="color: #008000;">=</span> api_key<span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//authenticate</span>
           acct.<span style="color: #0000FF;">authenticateValue</span> <span style="color: #008000;">=</span> credentials_a<span style="color: #008000;">;</span>
           svr.<span style="color: #0000FF;">authenticateValue</span> <span style="color: #008000;">=</span> credentials_b<span style="color: #008000;">;</span>
&nbsp;
           elapsed <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span>.<span style="color: #0000FF;">Subtract</span><span style="color: #000000;">&#40;</span>stopwatch<span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"done ("</span> <span style="color: #008000;">+</span>  elapsed.<span style="color: #0000FF;">TotalSeconds</span>.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">" seconds)"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"<span style="color: #008080; font-weight: bold;">\
</span>Press <enter> to exit."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">ReadLine</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #000000;">&#125;</span>
   <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre></div>
<p>At this point, we can go ahead and run our code. It doesn't really do anything all that useful. But never the less you should get an output similar to this.</p>
<p><img src="http://dev-sldn151.softlayer.local/sites/default/files/Blog_orm_console_1.png" alt="" /></p>
<p>While writing this article I connected to the SoftLayer API servers numerous times from my home. My connection times were pretty consistent. It took somewhere in the neighborhood of 20 seconds to get everything set up. That seems like a lot. But keep in mind that you only incur the overhead of connecting your services one time. Plus as we get a little further along in this article I will show you how we can use ORM to get rid of one of the references entirely. For now though, let's move on.</p>
<p>For someone of my background and mindset, what seemed the most straight-forward and correct way to find out which servers were running MS Windows was to access the public method "<a href="http://sldn.softlayer.com/wiki/index.php/SoftLayer_Hardware_Server::isWindowsServer">isWindowsServer()</a>". This is a method off the server class. That's why we needed to import the SoftLayer_Hardware_Server service. But we don't want to check the OS on a single server. We want to recurse through all the servers for an account. Which is why we brought in the SoftLayer_Account service and its attractive public offering "<a href="http://sldn.softlayer.com/wiki/index.php/SoftLayer_Account::getAllHardware">getAllHardware()</a>".</p>
<p>Keeping this plan in mind, let's go ahead and implement it in our console application.</p>
<div class="geshifilter">
<pre class="csharp geshifilter-csharp" style="font-family:monospace;"><span style="color: #0600FF;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Collections.Generic</span><span style="color: #008000;">;</span>
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Linq</span><span style="color: #008000;">;</span>
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Text</span><span style="color: #008000;">;</span>
&nbsp;
<span style="color: #0600FF;">namespace</span> SLDN_Magic
<span style="color: #000000;">&#123;</span>
   <span style="color: #FF0000;">class</span> Program
   <span style="color: #000000;">&#123;</span>
       <span style="color: #0600FF;">static</span> <span style="color: #0600FF;">void</span> Main<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">string</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> args<span style="color: #000000;">&#41;</span>
       <span style="color: #000000;">&#123;</span>
           <span style="color: #008080; font-style: italic;">//global timing vars</span>
           DateTime stopwatch<span style="color: #008000;">;</span>
           TimeSpan elapsed<span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//global container</span>
           SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Hardware</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> hw<span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//replace with your username and api key</span>
           <span style="color: #FF0000;">string</span> user_name <span style="color: #008000;">=</span> <span style="color: #666666;">"Replace With Your User Name"</span><span style="color: #008000;">;</span>
           <span style="color: #FF0000;">string</span> api_key <span style="color: #008000;">=</span> <span style="color: #666666;">"Replace With Your API Key"</span><span style="color: #008000;">;</span>
&nbsp;
           Console.<span style="color: #0000FF;">Write</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Establishing connection to SLDN service..."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//time it</span>
           stopwatch <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//declare the services</span>
           SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_AccountService</span> acct <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_AccountService</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           SLDN_SVR.<span style="color: #0000FF;">SoftLayer_Hardware_ServerService</span> svr <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_SVR.<span style="color: #0000FF;">SoftLayer_Hardware_ServerService</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span> 
&nbsp;
           <span style="color: #008080; font-style: italic;">//create an authentification object for each</span>
           SLDN_ACCT.<span style="color: #0000FF;">authenticate</span> credentials_a <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">authenticate</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           SLDN_SVR.<span style="color: #0000FF;">authenticate</span> credentials_b <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_SVR.<span style="color: #0000FF;">authenticate</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//assign credentials</span>
           credentials_a.<span style="color: #0000FF;">username</span> <span style="color: #008000;">=</span> credentials_b.<span style="color: #0000FF;">username</span> <span style="color: #008000;">=</span> user_name<span style="color: #008000;">;</span>
           credentials_a.<span style="color: #0000FF;">apiKey</span> <span style="color: #008000;">=</span> credentials_b.<span style="color: #0000FF;">apiKey</span> <span style="color: #008000;">=</span> api_key<span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//authenticate</span>
           acct.<span style="color: #0000FF;">authenticateValue</span> <span style="color: #008000;">=</span> credentials_a<span style="color: #008000;">;</span>
           svr.<span style="color: #0000FF;">authenticateValue</span> <span style="color: #008000;">=</span> credentials_b<span style="color: #008000;">;</span>
&nbsp;
           elapsed <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span>.<span style="color: #0000FF;">Subtract</span><span style="color: #000000;">&#40;</span>stopwatch<span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"done ("</span> <span style="color: #008000;">+</span> elapsed.<span style="color: #0000FF;">TotalSeconds</span>.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">" seconds)"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//butter knife method</span>
&nbsp;
           Console.<span style="color: #0000FF;">Write</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Retrieving hardware using method 1..."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//get time stamp</span>
           stopwatch <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span><span style="color: #008000;">;</span>
&nbsp;
           hw <span style="color: #008000;">=</span> null<span style="color: #008000;">;</span>
           <span style="color: #0600FF;">try</span>
           <span style="color: #000000;">&#123;</span>
               hw <span style="color: #008000;">=</span> acct.<span style="color: #0000FF;">getHardware</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           <span style="color: #000000;">&#125;</span>
           <span style="color: #0600FF;">catch</span> <span style="color: #000000;">&#40;</span>Exception e<span style="color: #000000;">&#41;</span>
           <span style="color: #000000;">&#123;</span>
               Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Exception encountered ["</span> <span style="color: #008000;">+</span> e.<span style="color: #0000FF;">Message</span> <span style="color: #008000;">+</span> <span style="color: #666666;">"]"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               hw <span style="color: #008000;">=</span> null<span style="color: #008000;">;</span>
           <span style="color: #000000;">&#125;</span>
&nbsp;
           <span style="color: #FF0000;">int</span> cnt <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #0600FF;">foreach</span> <span style="color: #000000;">&#40;</span>SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Hardware</span> server <span style="color: #0600FF;">in</span> hw<span style="color: #000000;">&#41;</span>
           <span style="color: #000000;">&#123;</span>
               <span style="color: #0600FF;">try</span>
               <span style="color: #000000;">&#123;</span>
                   SLDN_SVR.<span style="color: #0000FF;">SoftLayer_Hardware_ServerInitParameters</span> box <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_SVR.<span style="color: #0000FF;">SoftLayer_Hardware_ServerInitParameters</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
                   box.<span style="color: #0000FF;">id</span> <span style="color: #008000;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #FF0000;">int</span><span style="color: #000000;">&#41;</span>server.<span style="color: #0000FF;">id</span><span style="color: #008000;">;</span>
                   svr.<span style="color: #0000FF;">SoftLayer_Hardware_ServerInitParametersValue</span> <span style="color: #008000;">=</span> box<span style="color: #008000;">;</span>
                   <span style="color: #0600FF;">if</span> <span style="color: #000000;">&#40;</span>svr.<span style="color: #0000FF;">isWindowsServer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
                   <span style="color: #000000;">&#123;</span>
                       cnt<span style="color: #008000;">++;</span>
                   <span style="color: #000000;">&#125;</span>
               <span style="color: #000000;">&#125;</span>
               <span style="color: #0600FF;">catch</span> <span style="color: #000000;">&#40;</span>NullReferenceException<span style="color: #000000;">&#41;</span>
               <span style="color: #000000;">&#123;</span>
                   <span style="color: #008080; font-style: italic;">//ignore...this server has not had the </span>
                   <span style="color: #008080; font-style: italic;">//OS loaded on it yet!</span>
               <span style="color: #000000;">&#125;</span>
           <span style="color: #000000;">&#125;</span>
&nbsp;
           elapsed <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span>.<span style="color: #0000FF;">Subtract</span><span style="color: #000000;">&#40;</span>stopwatch<span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"done ("</span> <span style="color: #008000;">+</span> elapsed.<span style="color: #0000FF;">TotalSeconds</span>.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">" seconds)"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"counted "</span> <span style="color: #008000;">+</span> cnt.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">" MS Windows licenses"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"<span style="color: #008080; font-weight: bold;">\
</span>Press <enter> to exit."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">ReadLine</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #000000;">&#125;</span>
   <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre></div>
<p>That's it. Pretty straight forward stuff possibly with the exception of the way SLAPI allows you to reinitialize the server (or any object) on the fly by use of:"SoftLayer_Hardware_ServerInitParameters". If this confuses you, again I'll refer you to the blog "Dot Net? You Bet!". At this point, I think we are ready for another test run.</p>
<p><img src="http://dev-sldn151.softlayer.local/sites/default/files/BlogOrmConsole2.png" alt="" /></p>
<p>Once again we find ourselves in the twenty second range both for connecting the services and counting the hardware. What you can't tell from looking at this output is that the account I was using for testing had about 100 servers on it. So basically we are talking 1/5 of a second per server. It's certainly doable with a handful of servers, but this would obviously never work if you were trying to present this information real time to users if you managed 500 or 5,000 or 50,000 servers. So you are probably asking yourself the same thing I did. What gives? If SoftLayer wishes its customers success on an enterprise level, why create an API that comes to its knees when you start trying to manage more than a few hundred servers?</p>
<p>Luckily, the architects of SLAPI were a lot more web / database savvy than me. The above implementation, while correct syntactically, is a gross misuse of the SLAPI. It's the butter knife, when what we really need is the screwdriver. What we need are object masks. But exactly what are object masks and how do they relate to ORM?</p>
<p>The best way I have found to understand ORM and object masks, is to think of the SLAPI data objects, as a self supporting entities. Each object provides its own methods and exposes some properties specific to that object. Yet thanks to ORM, most objects can actually get to properties in related objects, through a process called tapping. You simply tap each object down the chain until you find the property or properties you are interested in, prior to retrieving an instance or instances of the object. Then the set of objects returned will expose any relevant properties in the same manner you tapped them.</p>
<p>For example in our case the SLDN architecture relates a server to an operating system in the following manner.</p>
<p><img src="http://dev-sldn151.softlayer.local/sites/default/files/BlogOrm3.png" alt="" /><br />
The diagram shows us that essentially, as long as we can get a hardware object, we can tap all the way down to the software description — which as the SLDN documentation states has a "name" property. There by we eliminate two of our most time consuming tasks from our original application. First off we no longer need to instantiate the SoftLayer_Hardware_Server service, since we can get to server from hardware and hardware can be retrieved via the account class. Secondly, if when we return the hardware it already contains the name of the operating system, we no longer have a need to call the "isWindows()" method. Take a look.</p>
<div class="geshifilter">
<pre class="csharp geshifilter-csharp" style="font-family:monospace;"><span style="color: #0600FF;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Collections.Generic</span><span style="color: #008000;">;</span>
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Linq</span><span style="color: #008000;">;</span>
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Text</span><span style="color: #008000;">;</span>
&nbsp;
<span style="color: #0600FF;">namespace</span> SLDN_Magic
<span style="color: #000000;">&#123;</span>
   <span style="color: #FF0000;">class</span> Program
   <span style="color: #000000;">&#123;</span>
       <span style="color: #0600FF;">static</span> <span style="color: #0600FF;">void</span> Main<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">string</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> args<span style="color: #000000;">&#41;</span>
       <span style="color: #000000;">&#123;</span>
           <span style="color: #008080; font-style: italic;">//global timing vars</span>
           DateTime stopwatch<span style="color: #008000;">;</span>
           TimeSpan elapsed<span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//global container</span>
           SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Hardware</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> hw<span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//replace with your username and api key</span>
           <span style="color: #FF0000;">string</span> user_name <span style="color: #008000;">=</span> <span style="color: #666666;">"Your User Name Here"</span><span style="color: #008000;">;</span>
           <span style="color: #FF0000;">string</span> api_key <span style="color: #008000;">=</span> <span style="color: #666666;">"Your Api Key Here"</span><span style="color: #008000;">;</span>
&nbsp;
           Console.<span style="color: #0000FF;">Write</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Establishing connection to SLDN service..."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//time it</span>
           stopwatch <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//declare the services</span>
           SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_AccountService</span> acct <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_AccountService</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//create an authentification object</span>
           SLDN_ACCT.<span style="color: #0000FF;">authenticate</span> credentials_a <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">authenticate</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//assign credentials</span>
           credentials_a.<span style="color: #0000FF;">username</span> <span style="color: #008000;">=</span> user_name<span style="color: #008000;">;</span>
           credentials_a.<span style="color: #0000FF;">apiKey</span> <span style="color: #008000;">=</span> api_key<span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//authenticate</span>
           acct.<span style="color: #0000FF;">authenticateValue</span> <span style="color: #008000;">=</span> credentials_a<span style="color: #008000;">;</span>
&nbsp;
           elapsed <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span>.<span style="color: #0000FF;">Subtract</span><span style="color: #000000;">&#40;</span>stopwatch<span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"done ("</span> <span style="color: #008000;">+</span> elapsed.<span style="color: #0000FF;">TotalSeconds</span>.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">" seconds)"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//method 2</span>
           Console.<span style="color: #0000FF;">Write</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Retrieving hardware using method 2..."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//get time stamp</span>
           stopwatch <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span><span style="color: #008000;">;</span>
&nbsp;
           hw <span style="color: #008000;">=</span> null<span style="color: #008000;">;</span>
           <span style="color: #008080; font-style: italic;">//attempt to pull a hardware list for this user</span>
           <span style="color: #0600FF;">try</span>
           <span style="color: #000000;">&#123;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_AccountObjectMask</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Account</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span>.<span style="color: #0000FF;">hardware</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Hardware_Server</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span>.<span style="color: #0000FF;">hardware</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Hardware_Server</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span>.<span style="color: #0000FF;">hardware</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span>.<span style="color: #0000FF;">operatingSystem</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Software_Component</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span>.<span style="color: #0000FF;">hardware</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span>.<span style="color: #0000FF;">operatingSystem</span>.<span style="color: #0000FF;">softwareLicense</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Software_License</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span>.<span style="color: #0000FF;">hardware</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span>.<span style="color: #0000FF;">operatingSystem</span>.<span style="color: #0000FF;">softwareLicense</span>.<span style="color: #0000FF;">softwareDescription</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Software_Description</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               hw <span style="color: #008000;">=</span> acct.<span style="color: #0000FF;">getHardware</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           <span style="color: #000000;">&#125;</span>
           <span style="color: #0600FF;">catch</span> <span style="color: #000000;">&#40;</span>Exception e<span style="color: #000000;">&#41;</span>
           <span style="color: #000000;">&#123;</span>
               Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Exception encountered ["</span> <span style="color: #008000;">+</span> e.<span style="color: #0000FF;">Message</span> <span style="color: #008000;">+</span> <span style="color: #666666;">"]"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               hw <span style="color: #008000;">=</span> null<span style="color: #008000;">;</span>
           <span style="color: #000000;">&#125;</span>
&nbsp;
           cnt <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #0600FF;">foreach</span> <span style="color: #000000;">&#40;</span>SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Hardware</span> server <span style="color: #0600FF;">in</span> hw<span style="color: #000000;">&#41;</span>
           <span style="color: #000000;">&#123;</span>
               <span style="color: #0600FF;">try</span>
               <span style="color: #000000;">&#123;</span>
                   <span style="color: #0600FF;">if</span> <span style="color: #000000;">&#40;</span>server.<span style="color: #0000FF;">operatingSystem</span>.<span style="color: #0000FF;">softwareLicense</span>.<span style="color: #0000FF;">softwareDescription</span>.<span style="color: #0000FF;">name</span>.<span style="color: #0000FF;">ToLower</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #0000FF;">Contains</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"windows"</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
                   <span style="color: #000000;">&#123;</span>
                       cnt<span style="color: #008000;">++;</span>
                   <span style="color: #000000;">&#125;</span>
               <span style="color: #000000;">&#125;</span>
               <span style="color: #0600FF;">catch</span> <span style="color: #000000;">&#40;</span>NullReferenceException<span style="color: #000000;">&#41;</span>
               <span style="color: #000000;">&#123;</span>
                   <span style="color: #008080; font-style: italic;">//ignore...this server has not </span>
                   <span style="color: #008080; font-style: italic;">//had the OS loaded on it yet<div style="color: #D8000C; background-color: #FFBABA; border: 1px solid; margin: 10px 10%; padding:15px 10px 15px 15px; width: 70%">!</span>
               <span style="color: #000000;">&#125;</span>
           <span style="color: #000000;">&#125;</span>
&nbsp;
           elapsed <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span>.<span style="color: #0000FF;">Subtract</span><span style="color: #000000;">&#40;</span>stopwatch<span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"done ("</span><span style="color: #008000;">+</span> elapsed.<span style="color: #0000FF;">TotalSeconds</span>.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">+</span><span style="color: #666666;">" seconds)"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"counted "</span> <span style="color: #008000;">+</span> cnt.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">" MS Windows licenses"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"<span style="color: #008080; font-weight: bold;">\
</span>Press <enter> to exit."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">ReadLine</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #000000;">&#125;</span>
   <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre></div>
<p>You should notice right away all the references to SoftLayer_AccountObjectMaskValue prior to calling the "getHardware()" method. This is the object mask. Essentially we must create a new instance of each entity we want to include down the chain. Then when the target object is retrieved, in our case the hardware, all related objects which we have made room for will get created for that specific instance of hardware, assuming of course a record exists. You must instantiate each object down the chain. If you skip any link your result set will not conatain the property or method you were trying to get to. Some less structured langagues, like PHP, do not have this requirement. But with V3 and dot NET there is no getting around it. You're probably thinking this version of the code looks far more cluttered and is not as straight-forward to read. You're right. But I contend this is the electric screwdriver in the SLDN toolbox. See for yourself.</p>
<p><img src="http://dev-sldn151.softlayer.local/sites/default/files/Image004.png" alt="" /></p>
<p>As you can see the connection overhead dropped in half, which is to be expected since we are only authenticating to half the number of services. But take a look at the second number, the number of seconds it takes to count the servers with Windows installed. It dropped from 20 seconds, to under 2 seconds. That's a 10 times speed gain. And wait there's more-- because we are only making one call to the SLDN application servers to retrieve those records what you see is what you get. Meaning you should not expect that time to increase noticeably whether you have a hundred servers or a hundred thousand servers! That my friend is the magic of V3. The power of ORM.</p>
<p>Following this article I will include the entire code base, in a combined application that lets you run the tests sequentially so you can see the amazing difference object masks make for yourself. In the second part to this article, we'll continue with the sample so if you download it keep it handy. In part two I'll discuss the next best thing to object masks—object filters. With object filters we'll be able to streamline this code even more. Until then…happy SLDNing!</p>
<div class="geshifilter">
<pre class="csharp geshifilter-csharp" style="font-family:monospace;"><span style="color: #0600FF;">using</span> <span style="color: #008080;">System</span><span style="color: #008000;">;</span>
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Collections.Generic</span><span style="color: #008000;">;</span>
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Linq</span><span style="color: #008000;">;</span>
<span style="color: #0600FF;">using</span> <span style="color: #008080;">System.Text</span><span style="color: #008000;">;</span>
&nbsp;
<span style="color: #0600FF;">namespace</span> SLDN_Magic
<span style="color: #000000;">&#123;</span>
   <span style="color: #FF0000;">class</span> Program
   <span style="color: #000000;">&#123;</span>
       <span style="color: #0600FF;">static</span> <span style="color: #0600FF;">void</span> Main<span style="color: #000000;">&#40;</span><span style="color: #FF0000;">string</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> args<span style="color: #000000;">&#41;</span>
       <span style="color: #000000;">&#123;</span>
           <span style="color: #008080; font-style: italic;">//global timing vars</span>
           DateTime stopwatch<span style="color: #008000;">;</span>
           TimeSpan elapsed<span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//global container</span>
           SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Hardware</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> hw<span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//replace with your username and api key</span>
           <span style="color: #FF0000;">string</span> user_name <span style="color: #008000;">=</span> <span style="color: #666666;">""</span><span style="color: #008000;">;</span>
           <span style="color: #FF0000;">string</span> api_key <span style="color: #008000;">=</span> <span style="color: #666666;">""</span><span style="color: #008000;">;</span>
&nbsp;
           Console.<span style="color: #0000FF;">Write</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Establishing connection to SLDN service..."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//time it</span>
           stopwatch <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//declare the services</span>
           SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_AccountService</span> acct <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_AccountService</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           SLDN_SVR.<span style="color: #0000FF;">SoftLayer_Hardware_ServerService</span> svr <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_SVR.<span style="color: #0000FF;">SoftLayer_Hardware_ServerService</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span> 
&nbsp;
           <span style="color: #008080; font-style: italic;">//create an authentification object for each</span>
           SLDN_ACCT.<span style="color: #0000FF;">authenticate</span> credentials_a <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">authenticate</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           SLDN_SVR.<span style="color: #0000FF;">authenticate</span> credentials_b <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_SVR.<span style="color: #0000FF;">authenticate</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//assign credentials</span>
           credentials_a.<span style="color: #0000FF;">username</span> <span style="color: #008000;">=</span> credentials_b.<span style="color: #0000FF;">username</span> <span style="color: #008000;">=</span> user_name<span style="color: #008000;">;</span>
           credentials_a.<span style="color: #0000FF;">apiKey</span> <span style="color: #008000;">=</span> credentials_b.<span style="color: #0000FF;">apiKey</span> <span style="color: #008000;">=</span> api_key<span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//authenticate</span>
           acct.<span style="color: #0000FF;">authenticateValue</span> <span style="color: #008000;">=</span> credentials_a<span style="color: #008000;">;</span>
           svr.<span style="color: #0000FF;">authenticateValue</span> <span style="color: #008000;">=</span> credentials_b<span style="color: #008000;">;</span>
&nbsp;
           elapsed <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span>.<span style="color: #0000FF;">Subtract</span><span style="color: #000000;">&#40;</span>stopwatch<span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"done ("</span> <span style="color: #008000;">+</span> elapsed.<span style="color: #0000FF;">TotalSeconds</span>.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">" seconds)"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//method 1</span>
&nbsp;
           Console.<span style="color: #0000FF;">Write</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Retrieving hardware using method 1..."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//get time stamp</span>
           stopwatch <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span><span style="color: #008000;">;</span>
&nbsp;
           hw <span style="color: #008000;">=</span> null<span style="color: #008000;">;</span>
           <span style="color: #0600FF;">try</span>
           <span style="color: #000000;">&#123;</span>
               hw <span style="color: #008000;">=</span> acct.<span style="color: #0000FF;">getHardware</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           <span style="color: #000000;">&#125;</span>
           <span style="color: #0600FF;">catch</span> <span style="color: #000000;">&#40;</span>Exception e<span style="color: #000000;">&#41;</span>
           <span style="color: #000000;">&#123;</span>
               Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Exception encountered ["</span> <span style="color: #008000;">+</span> e.<span style="color: #0000FF;">Message</span> <span style="color: #008000;">+</span> <span style="color: #666666;">"]"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               hw <span style="color: #008000;">=</span> null<span style="color: #008000;">;</span>
           <span style="color: #000000;">&#125;</span>
&nbsp;
           <span style="color: #FF0000;">int</span> cnt <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #0600FF;">foreach</span> <span style="color: #000000;">&#40;</span>SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Hardware</span> server <span style="color: #0600FF;">in</span> hw<span style="color: #000000;">&#41;</span>
           <span style="color: #000000;">&#123;</span>
               <span style="color: #0600FF;">try</span>
               <span style="color: #000000;">&#123;</span>
                   SLDN_SVR.<span style="color: #0000FF;">SoftLayer_Hardware_ServerInitParameters</span> box <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_SVR.<span style="color: #0000FF;">SoftLayer_Hardware_ServerInitParameters</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
                   box.<span style="color: #0000FF;">id</span> <span style="color: #008000;">=</span> <span style="color: #000000;">&#40;</span><span style="color: #FF0000;">int</span><span style="color: #000000;">&#41;</span>server.<span style="color: #0000FF;">id</span><span style="color: #008000;">;</span>
                   svr.<span style="color: #0000FF;">SoftLayer_Hardware_ServerInitParametersValue</span> <span style="color: #008000;">=</span> box<span style="color: #008000;">;</span>
                   <span style="color: #0600FF;">if</span> <span style="color: #000000;">&#40;</span>svr.<span style="color: #0000FF;">isWindowsServer</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
                   <span style="color: #000000;">&#123;</span>
                       cnt<span style="color: #008000;">++;</span>
                   <span style="color: #000000;">&#125;</span>
               <span style="color: #000000;">&#125;</span>
               <span style="color: #0600FF;">catch</span> <span style="color: #000000;">&#40;</span>NullReferenceException<span style="color: #000000;">&#41;</span>
               <span style="color: #000000;">&#123;</span>
                   <span style="color: #008080; font-style: italic;">//ignore...this server has not had the OS loaded on it yet</span>
               <span style="color: #000000;">&#125;</span>
           <span style="color: #000000;">&#125;</span>
&nbsp;
           elapsed <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span>.<span style="color: #0000FF;">Subtract</span><span style="color: #000000;">&#40;</span>stopwatch<span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"done ("</span> <span style="color: #008000;">+</span> elapsed.<span style="color: #0000FF;">TotalSeconds</span>.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">" seconds)"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"counted "</span> <span style="color: #008000;">+</span> cnt.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">" MS Windows licenses"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//method 2</span>
           Console.<span style="color: #0000FF;">Write</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Retrieving hardware using method 2..."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #008080; font-style: italic;">//get time stamp</span>
           stopwatch <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span><span style="color: #008000;">;</span>
&nbsp;
           hw <span style="color: #008000;">=</span> null<span style="color: #008000;">;</span>
           <span style="color: #008080; font-style: italic;">//attempt to pull a hardware list for this user</span>
           <span style="color: #0600FF;">try</span>
           <span style="color: #000000;">&#123;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_AccountObjectMask</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Account</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span>.<span style="color: #0000FF;">hardware</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Hardware_Server</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">1</span><span style="color: #000000;">&#93;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span>.<span style="color: #0000FF;">hardware</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Hardware_Server</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span>.<span style="color: #0000FF;">hardware</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span>.<span style="color: #0000FF;">operatingSystem</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Software_Component</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span>.<span style="color: #0000FF;">hardware</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span>.<span style="color: #0000FF;">operatingSystem</span>.<span style="color: #0000FF;">softwareLicense</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Software_License</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               acct.<span style="color: #0000FF;">SoftLayer_AccountObjectMaskValue</span>.<span style="color: #0000FF;">mask</span>.<span style="color: #0000FF;">hardware</span><span style="color: #000000;">&#91;</span><span style="color: #FF0000;">0</span><span style="color: #000000;">&#93;</span>.<span style="color: #0000FF;">operatingSystem</span>.<span style="color: #0000FF;">softwareLicense</span>.<span style="color: #0000FF;">softwareDescription</span> <span style="color: #008000;">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span style="color: #008000;">new</span></a> SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Software_Description</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               hw <span style="color: #008000;">=</span> acct.<span style="color: #0000FF;">getHardware</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           <span style="color: #000000;">&#125;</span>
           <span style="color: #0600FF;">catch</span> <span style="color: #000000;">&#40;</span>Exception e<span style="color: #000000;">&#41;</span>
           <span style="color: #000000;">&#123;</span>
               Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"Exception encountered ["</span> <span style="color: #008000;">+</span> e.<span style="color: #0000FF;">Message</span> <span style="color: #008000;">+</span> <span style="color: #666666;">"]"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
               hw <span style="color: #008000;">=</span> null<span style="color: #008000;">;</span>
           <span style="color: #000000;">&#125;</span>
&nbsp;
           cnt <span style="color: #008000;">=</span> <span style="color: #FF0000;">0</span><span style="color: #008000;">;</span>
&nbsp;
           <span style="color: #0600FF;">foreach</span> <span style="color: #000000;">&#40;</span>SLDN_ACCT.<span style="color: #0000FF;">SoftLayer_Hardware</span> server <span style="color: #0600FF;">in</span> hw<span style="color: #000000;">&#41;</span>
           <span style="color: #000000;">&#123;</span>
               <span style="color: #0600FF;">try</span>
               <span style="color: #000000;">&#123;</span>
                   <span style="color: #0600FF;">if</span> <span style="color: #000000;">&#40;</span>server.<span style="color: #0000FF;">operatingSystem</span>.<span style="color: #0000FF;">softwareLicense</span>.<span style="color: #0000FF;">softwareDescription</span>.<span style="color: #0000FF;">name</span>.<span style="color: #0000FF;">ToLower</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #0000FF;">Contains</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"windows"</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>
                   <span style="color: #000000;">&#123;</span>
                       cnt<span style="color: #008000;">++;</span>
                   <span style="color: #000000;">&#125;</span>
               <span style="color: #000000;">&#125;</span>
               <span style="color: #0600FF;">catch</span> <span style="color: #000000;">&#40;</span>NullReferenceException<span style="color: #000000;">&#41;</span>
               <span style="color: #000000;">&#123;</span>
                   <span style="color: #008080; font-style: italic;">//ignore...this server has not had the OS loaded on it yet</span>
               <span style="color: #000000;">&#125;</span>
           <span style="color: #000000;">&#125;</span>
&nbsp;
           elapsed <span style="color: #008000;">=</span> DateTime.<span style="color: #0000FF;">Now</span>.<span style="color: #0000FF;">Subtract</span><span style="color: #000000;">&#40;</span>stopwatch<span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"done ("</span><span style="color: #008000;">+</span>elapsed.<span style="color: #0000FF;">TotalSeconds</span>.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">+</span><span style="color: #666666;">" seconds)"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"counted "</span> <span style="color: #008000;">+</span> cnt.<span style="color: #0000FF;">ToString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #008000;">+</span> <span style="color: #666666;">" MS Windows licenses"</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
&nbsp;
           Console.<span style="color: #0000FF;">WriteLine</span><span style="color: #000000;">&#40;</span><span style="color: #666666;">"<span style="color: #008080; font-weight: bold;">\
</span>Press <enter> to exit."</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
           Console.<span style="color: #0000FF;">ReadLine</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #008000;">;</span>
       <span style="color: #000000;">&#125;</span>
   <span style="color: #000000;">&#125;</span>
<span style="color: #000000;">&#125;</span></pre></div>
</div>

            </div>
        </div>

    </div>
    <hr>
    <div class="row">
        <div class="row">
            <div class="col-md-6">
    <div class="well well-sm" style="word-wrap: break-word;"> 
        <strong>Feedback? <span class="fas fa-comment"/></strong>
            <p>
                If this article contains any error, or leaves any of your questions unanswered, please help us out by 
                opening up a github issue.<br>
                <a class="" href="https://github.com/softlayer/githubio_source/issues/new?title=Feedback%20for%20blog%20-%20Object%20Masks%20and%20Filters%20in%20C%20Sharp&body=Feedback+regarding%3A%20https%3a%2f%2fsldn.softlayer.com%2fblog%2fwfrancis%2fobject-masks-and-filters-c-sharp%2f"> Open an issue</a>
                <i class="fab fa-github" alt="github"></i>
            </p>
    </div>
</div>
        </div>
    </div>
<footer>
    <div class="row">
        <div class="col-sm-12">
            <p>&copy; SoftLayer 2022<br>
            Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
        </div>
    </div>
</footer>
</div>

    <script src="https://sldn.softlayer.com/js/jquery.js"></script>
    <script src="https://sldn.softlayer.com/js/bootstrap.js"></script>
</body>
</html>

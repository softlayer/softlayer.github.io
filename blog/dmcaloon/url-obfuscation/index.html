<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>URL Obfuscation - https://sldn.softlayer.com/</title>
    <link rel="canonical" href="https://sldn.softlayer.com/blog/dmcaloon/url-obfuscation/">
        <link href="https://sldn.softlayer.com/css/main.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/bootstrap.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/custom.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/monokai.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/highlight/solarized_dark.css" rel="stylesheet">
    

    <script src="https://sldn.softlayer.com/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://sldn.softlayer.com/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://sldn.softlayer.com/js/jquery-3.3.1.min.js"></script> 
    <script src="https://sldn.softlayer.com/js/sldn.js"></script>


    <link href="https://sldn.softlayer.com/fontawesome/css/fontawesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/brands.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/solid.min.css" rel="stylesheet" type="text/css">
    
    <script defer src="https://sldn.softlayer.com/fontawesome/js/solid.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/brands.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/fontawesome.min.js"></script>

    <script>
        var head = document.getElementsByTagName('head')[0]
        var style = document.createElement('link')
        style.type = 'text/css'
        style.rel = 'stylesheet'
        style.id = "dark-theme"
        if (localStorage.getItem("dark-mode-theme") == "dark") {
            style.href = '/css/dark.css'
        } else {
            style.href = '/css/light.css'
        }
        head.append(style)
    </script>

    <script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
            setThemeMode(localStorage.getItem("dark-mode-theme") || "dark");
		})
	</script>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9XPZ9ZBSJE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-9XPZ9ZBSJE', { 'anonymize_ip': false });
}
</script>

</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="nav-container">
            <div class="navbar-header" style="width: 150px">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://sldn.softlayer.com/">SoftLayer API</a>
            </div>

            <div class="navbar-header" style="width: calc(100% - 350px)">
                <ul class="nav navbar-nav" style="width: 100%">
                    
                        <li><a href="https://sldn.softlayer.com/article/">Articles</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/reference/softlayerapi">Docs</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/go/">Go</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/java/">Java</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/php/">PHP</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/python/">Python</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/rest/">Rest</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/ruby/">Ruby</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/tools/">Tools</a></li>
                    
                    <li class="nav-item">
                        <a id="dark-toggle" class="dark-mode-toggle" aria-label="dark-mode-toggle" style="color: var(--Red); font-size: 20px">
                            <i class="fas fa-sun"></i>
                        </a>
                    </li>
                </ul>
            </div>

            <div id="custom-search-input" class="pull-right" style="width: 200px">
              <form class="navbar-form" role="search" method="get" action="https://www.bing.com/search">
                <div class="input-group col-md-12">
                  <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                  <input type="hidden" name="q1" value="site:sldn.softlayer.com" />
                  <div class="input-group-btn">
                    <button class="btn btn-info" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </div>
                </div>
              </form>
            </div>

        </div>
    </nav>

<script type="text/javascript">
const darkIconClass = 'fas fa-moon'
const lightIconClass = 'fas fa-sun'
var darkCSS = $("#dark-theme");
var darkToggleIcon = $("#dark-toggle i");




function setThemeMode(mode) {
    localStorage.setItem("dark-mode-theme", mode);
    if (mode === "dark") {
        darkToggleIcon.attr('class', darkIconClass)
    } else  {
        darkToggleIcon.attr('class', lightIconClass)
    }
}


$("#dark-toggle").click(function () {
  if (darkToggleIcon.attr("class") == lightIconClass) {
    setThemeMode("dark")
  } else if (darkToggleIcon.attr("class") == darkIconClass) {
    setThemeMode("light")
  }
  location.reload();
});
</script>
<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>October 31, 2008<br></h4>
            </div>
        </div>
        <div class="col-md-9">

                <strong>Classes <span class="fa fa-book"/></strong>
                
                <br>
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/blog">blog</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
		<div class="col-md-12">
            <div class="well well-sm  article" style="word-wrap: break-word;">
                <div class="article-title">
				    <h1>URL Obfuscation</h1>
                    <small>&lt;div style=text-align: left;&gt;On August 26, our CTO Nathan Day wrote a &lt;a href=http://theinnerlayer.softlayer.com/2008</small>
                </div>
				
                
				
                <div style="text-align: left;">On August 26, our CTO Nathan Day wrote a <a href="http://theinnerlayer.softlayer.com/2008/do-you-know-where-your-nameserver-is/">post on the InnerLayer blog about nameservers</a>.  His straightforward explanation of nameservers and their operations got me thinking about how NOT straightforward the whole operation is.  </p>
<p>The way Nathan explained it, you type in “theinnerlayer.softlayer.com” and it is translated to an IP address, which is then contacted, and the page is returned to you.  However, if you know the IP address already, you can use that instead of the URL, and skip the nameserver entirely.  For instance, <a href=”http://66.228.119.19”>http://66.228.119.19</a> will take you directly to the InnerLayer blog, bypassing the name server.  But that's not all!  Not only will the dotted-decimal representation of the IP work in a url, but the dword representation will as well!  Try <a href="http://1122268947">http://1122268947</a>.  That will also get you to the InnerLayer.  </p>
<p>Now that we've gotten the domain out of the way, what about the bits before and after?  Before the domain, between the protocol (http) and the domain itself, there is an optional authentication part.  You can specify a username to log into secured sites right in the URL.  <a href="http://en.wikipedia.org/wiki/Basic_access_authentication">http://user:pass@site.com</a> is the standard format for such logins.  However, if the website you're going to doesn't require authentication, most browsers simply ignore it.  FireFox 3 will prompt you when you click on these obfuscated links to ask you if "site.com" is really the site you wish to visit, where IE7 simply won't work at all if there's an unexpected authentication string.  This is a fairly new feature, and it's a good way to protect users against this sort of attack.  Now that you know about the methods of obfuscating domain names in URLs, you can probably see how <a href="http://www.bankofamerica.com%20login@1122268947">http://www.bankofamerica.com%20login@1122268947</a> actually redirects to the InnerLayer.  This is a common tactic used by spammers and phishers to obfuscate their URLs.  You can put anything you want into the authentication portion of the URL to obfuscate it, as long as it's not a reserved URL character like colon, "at" sign, or forward slash.  For our case, let's use "4NDIw:U4ODYwMCAxMjE5" as our fake authentication data, just to be confusing.</p>
<p>Now that we've added stuff to the beginning of the URL, what about the filename at the end?  Nathan's post could easily be accessed using <a href="http://4NDIw:U4ODYwMCAxMjE5@1122268947/2008/do-you-know-where-your-nameserver-is/">http://4NDIw:U4ODYwMCAxMjE5@1122268947/2008/do-you-know-where-your-nameserver-is/</a>.  However, there's still all that easy-to-read nonsense at the end.  That will never do.  Have you ever seen a URL with a space in it?  The space is encoded as %20.  That's the hexadecimal representation of the ASCII code 32, a space.  The percent sign indicates that the following 2 digits are to be interpreted as a hex code for a real character.  This is how you keep URLs from breaking on spaces, you turn the spaces into non-breaking characters.  However, did you know it works for ALL characters and not just spaces?  We can change every character but the forward slashes in any url to their hex equivalents.  Nathan's article link then becomes: <a href="http://4NDIw:U4ODYwMCAxMjE5@1122268947/%32%30%30%38/%64%6f%2d%79%6f%75%2d%6b%6e%6f%77%2d%77%68%65%72%65%2d%79%6f%75%72%2d%6e%61%6d%65%73%65%72%76%65%72%2d%69%73">http://4NDIw:U4ODYwMCAxMjE5@1122268947/%32%30%30%38/%64%6f%2d%79%6f<br />%75%2d%6b%6e%6f%77%2d%77%68%65%72%65%2d%79%6f%75%72%2d%6e%61<br />%6d%65%73%65%72%76%65%72%2d%69%73</a>.  </p>
<p>But wait, there's more!  Let's go back to the domain name, shall we?  Most browsers will handle overflow in the dword representation of the domain just fine.  What that means is that we can continually add 4294967296 (2^32) to the domain portion of our obfuscated URL and still continue to get the results we want.  Our URL is now: <a href="http://4NDIw:U4ODYwMCAxMjE5@5417236243/%32%30%30%38/%64%6f%2d%79%6f%75%2d%6b%6e%6f%77%2d%77%68%65%72%65%2d%79%6f%75%72%2d%6e%61%6d%65%73%65%72%76%65%72%2d%69%73">http://4NDIw:U4ODYwMCAxMjE5<br />@5417236243/%32%30%30%38/%64%6f%2d%79%6f%75%2d%6b%6e%6f%77%2d%77<br />%68%65%72%65%2d%79%6f%75%72%2d%6e%61%6d%65%73%65%72%76%65%72<br />%2d%69%73</a>.  </p>
<p>As a final trick, you don't have to obfuscate every letter.  A fixed pattern of %xx%xx%xx over and over again will get boring.  Mix it up.  I only converted 70% of my URL to hex, resulting in this gem: <a href="http://4NDIw:U4ODYwMCAxMjE5@5417236243//%3200%38/%64%6f%2d%79%6f%75%2d%6b%6e%6f%77-%77%68%65%72e%2d%79%6f%75%72-%6e%61%6d%65%73e%72v%65%72%2di%73">http://4NDIw:U4ODYwMCAxMjE5@5417236243//%3200%38/%64%6f%2d%79%6f%75<br />%2d%6b%6e%6f%77-%77%68%65%72e%2d%79%6f%75%72-%6e%61%6d%65%73e<br />%72v%65%72%2di%73</a>.  As you can see, this is quite a bit more confusing than the original URL, which was <a href="http://theinnerlayer.softlayer.com/2008/do-you-know-where-your-nameserver-is/">http://theinnerlayer.softlayer.com/2008/do-you-know-where-your-nameserver-is/</a>.  </p>
<p>This information can be useful to any systems administrator who is dealing with an elusive, abusive user.  Being able to translate a crazy URL to the actual human-readable equivalent can greatly assist both the SoftLayer abuse department as well as any other group attempting to track down spammers, scammers, or just plain old sneaky users.</p>
<p>As a final note: Please don't use this knowledge for evil.  As mentioned before, the new versions of both FireFox and Internet Explorer are no longer fooled by the fake authentication string trick, and the rest of the obfuscation should really only be used to fool web spiders.  Personally, I used this method in combination with javascript to obfuscate links and email addresses so that I wouldn't get spammed.  </p>
<p>The following PHP code was used to generate the links in this article.</p>
<p><b>[Editor's note: We at SoftLayer use our powers for good and so should you. Thankfully half of these kinds of links won't open in the latest versions of Outlook and Safari. -K]</b></p>
<p><span style="color: #000000"><br />
<span style="color: #0000BB"><?php</p>
<p></span><span style="color: #FF8000">//the&nbsp;URL&nbsp;we're&nbsp;attempting&nbsp;to&nbsp;obfuscate<br /></span><span style="color: #0000BB">$url&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"http://theinnerlayer.softlayer.com/2008/do-you-know-where-your-nameserver-is/"</span><span style="color: #007700">;</p>
<p></span><span style="color: #0000BB">$urlData&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parse_url</span><span style="color: #007700">(</span><span style="color: #0000BB">$url</span><span style="color: #007700">);</p>
<p></span><span style="color: #0000BB">$path&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$urlData</span><span style="color: #007700">[</span><span style="color: #DD0000">'path'</span><span style="color: #007700">];</p>
<p></span><span style="color: #0000BB">$startingIP&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">gethostbyname</span><span style="color: #007700">(</span><span style="color: #0000BB">$urlData</span><span style="color: #007700">[</span><span style="color: #DD0000">'host'</span><span style="color: #007700">]);</p>
<p></span><span style="color: #FF8000">//get&nbsp;the&nbsp;long&nbsp;representation:<br /></span><span style="color: #0000BB">$long&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ip2long</span><span style="color: #007700">(</span><span style="color: #0000BB">$startingIP</span><span style="color: #007700">);</p>
<p></span><span style="color: #FF8000">//add&nbsp;4294967296&nbsp;to&nbsp;the&nbsp;long&nbsp;for&nbsp;further&nbsp;obfuscation:<br /></span><span style="color: #0000BB">$long&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">4294967296</span><span style="color: #007700">;</p>
<p></span><span style="color: #FF8000">//add&nbsp;random&nbsp;authentication&nbsp;characters&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;string:<br /></span><span style="color: #0000BB">$auth&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">base64_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">microtime</span><span style="color: #007700">()),&nbsp;</span><span style="color: #0000BB">rand</span><span style="color: #007700">(</span><span style="color: #0000BB">5</span><span style="color: #007700">,</span><span style="color: #0000BB">10</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">rand</span><span style="color: #007700">(</span><span style="color: #0000BB">5</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">15</span><span style="color: #007700">))&nbsp;.&nbsp;</span><span style="color: #DD0000">":"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">base64_encode</span><span style="color: #007700">(</span><span style="color: #0000BB">microtime</span><span style="color: #007700">()),&nbsp;</span><span style="color: #0000BB">rand</span><span style="color: #007700">(</span><span style="color: #0000BB">5</span><span style="color: #007700">,</span><span style="color: #0000BB">10</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">rand</span><span style="color: #007700">(</span><span style="color: #0000BB">5</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">15</span><span style="color: #007700">));</p>
<p></span><span style="color: #FF8000">//obfuscate&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;URL<br /></span><span style="color: #0000BB">$len&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$path</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$obfuscatedLocation&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">;</p>
<p>for&nbsp;(&nbsp;</span><span style="color: #0000BB">$p&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$p&nbsp;</span><span style="color: #007700"><&nbsp;</span><span style="color: #0000BB">$len</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$p</span><span style="color: #007700">++&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//check&nbsp;for&nbsp;slashes<br />&nbsp;&nbsp;&nbsp;&nbsp;//also,&nbsp;3&nbsp;in&nbsp;10&nbsp;characters&nbsp;make&nbsp;it&nbsp;through&nbsp;plain&nbsp;for&nbsp;further&nbsp;confusion</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(&nbsp;</span><span style="color: #0000BB">$path</span><span style="color: #007700">[</span><span style="color: #0000BB">$p</span><span style="color: #007700">]&nbsp;= =&nbsp;</span><span style="color: #DD0000">'/'&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">rand</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">)&nbsp;>&nbsp;</span><span style="color: #0000BB">7&nbsp;</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$obfuscatedLocation&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #0000BB">$path</span><span style="color: #007700">[</span><span style="color: #0000BB">$p</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//made&nbsp;it&nbsp;here,&nbsp;obfuscate&nbsp;this&nbsp;character:<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$obfuscatedLocation&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">'%'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">dechex</span><span style="color: #007700">(</span><span style="color: #0000BB">ord</span><span style="color: #007700">(</span><span style="color: #0000BB">$path</span><span style="color: #007700">[</span><span style="color: #0000BB">$p</span><span style="color: #007700">]));<br />}</p>
<p>echo&nbsp;</span><span style="color: #DD0000">"http://$auth@$long$obfuscatedLocation"</span><span style="color: #007700">;</p>
<p></span><span style="color: #0000BB">?><br /></span><br />
</span>
</div>

            </div>
        </div>

    </div>
    <hr>
    <div class="row">
        <div class="row">
            <div class="col-md-6">
    <div class="well well-sm footer" style="word-wrap: break-word;"> 
        <strong>Feedback? <span class="fas fa-comment"/></strong>
            <p>
                If this article contains any error, or leaves any of your questions unanswered, please help us out by 
                opening up a github issue.<br>
                <a class="" href="https://github.com/softlayer/githubio_source/issues/new?title=Feedback%20for%20blog%20-%20URL%20Obfuscation&body=Feedback+regarding%3A%20https%3a%2f%2fsldn.softlayer.com%2fblog%2fdmcaloon%2furl-obfuscation%2f"> Open an issue</a>
                <i class="fab fa-github" alt="github"></i>
                <span> - </span>
                <a class="" href="https://github.com/softlayer/githubio_source/edit/master/content/blog/blog/dmcaloon/url-obfuscation.md" style="text-align: right;"> Quick Edit</a>
                <i class="fab fa-github" alt="github"></i>

            </p>
    </div>
</div>

        </div>
    </div>
<footer>
    <div class="row">
        <div class="col-sm-12 footer">
            <p>&copy; SoftLayer 2024<br>
            Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
        </div>
    </div>
</footer>
</div>

    <script src="https://sldn.softlayer.com/js/jquery.js"></script>
    <script src="https://sldn.softlayer.com/js/bootstrap.js"></script>
</body>
</html>

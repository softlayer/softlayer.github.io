<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>Using fog-softlayer for Managing Key Pairs - https://sldn.softlayer.com/</title>
    <link rel="canonical" href="https://sldn.softlayer.com/blog/matteldridge/using-fog-softlayer-managing-key-pairs/">
        <link href="https://sldn.softlayer.com/css/main.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/bootstrap.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/custom.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/monokai.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/highlight/solarized_dark.css" rel="stylesheet">

    <script src="https://sldn.softlayer.com/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://sldn.softlayer.com/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://sldn.softlayer.com/js/jquery-3.3.1.min.js"></script> 
    <script src="https://sldn.softlayer.com/js/sldn.js"></script>


    <link href="https://sldn.softlayer.com/fontawesome/css/fontawesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/brands.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/solid.min.css" rel="stylesheet" type="text/css">
    
    <script defer src="https://sldn.softlayer.com/fontawesome/js/solid.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/brands.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/fontawesome.min.js"></script>

    <script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
		})
	</script>
   
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9XPZ9ZBSJE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-9XPZ9ZBSJE');
</script>
</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://sldn.softlayer.com/">SoftLayer API</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                        <li><a href="https://sldn.softlayer.com/article/">Articles</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/reference/softlayerapi">Documentation</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/go/">Go</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/java/">Java</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/perl/">Perl</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/php/">PHP</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/python/">Python</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/rest/">Rest</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/ruby/">Ruby</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/tools/">Tools</a></li>
                    

                    
                </ul>
                <div id="custom-search-input" class="pull-right">
                  <form class="navbar-form" role="search" method="get" action="https://www.bing.com/search">
                    <div class="input-group col-md-12">
                      <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                      <input type="hidden" name="q1" value="site:sldn.softlayer.com" />
                      <div class="input-group-btn">
                        <button class="btn btn-info" type="submit">
                          <i class="glyphicon glyphicon-search"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>July 30, 2014<br></h4>
            </div>
        </div>
        <div class="col-md-9">

                <strong>Classes <span class="fa fa-book"/></strong>
                
                <br>
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/blog">blog</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
		<div class="col-md-12">
            <div class="well well-sm  article" style="word-wrap: break-word;">
                <div class="article-title">
				    <h1>Using fog-softlayer for Managing Key Pairs</h1>
                    <small>In [part four]( http://sldn.softlayer.com/blog/matteldridge/Using-fog-softlayer-Managing-DNS ) of this series, we explor</small>
                </div>
				
                
				
                <p>In <a href="http://sldn.softlayer.com/blog/matteldridge/Using-fog-softlayer-Managing-DNS">part four</a> of this series, we explored using <a href="https://github.com/softlayer/fog-softlayer">fog-softlayer</a> for managing your SoftLayer tags.</p>
<p>In this post, we&rsquo;ll look at creating and assigning SSH key pairs for use with our compute instances.</p>
<h5 id="key-pair-examples">Key Pair Examples</h5>
<p>These examples all assume you have <code>~/.fog</code>, which contains the following:</p>
   <code>
default:
  softlayer_username: example-username
  softlayer_api_key: 1a1a1a1a1a1a1a1a1a11a1a1a1a1a1a1a1a1a1 
  softlayer_default_domain: example.com
  </code>
<h5 id="create-a-connection-to-softlayer-compute-service">Create a Connection to SoftLayer Compute Service</h5>
<ruby>
require 'fog/softlayer'
@sl = Fog::Compute[:softlayer]
</ruby><br>
<h5 id="key-pair-basics">Key Pair Basics</h5>
<p>Create some new key pairs:
<ruby>
kp1 = @sl.key_pairs.create(:label =&gt; &lsquo;my-new-key&rsquo;, :key =&gt; &lsquo;ssh-rsa AAAAxbU2lx&hellip;&rsquo;)</p>
<h1 id="-fogcomputesoftlayerkeypair">=&gt; <a href="Fog::Compute::Softlayer::KeyPair">Fog::Compute::Softlayer::KeyPair</a></h1>
<p>kp2 = @sl.key_pairs.new
kp2.label = &lsquo;my-new-new-key&rsquo;
kp2.key = &lsquo;ssh-rsa AAAAxbU2lx&hellip;&rsquo;
kp2.save</p>
<h1 id="-fogcomputesoftlayerkeypair-1">=&gt; <a href="Fog::Compute::Softlayer::KeyPair">Fog::Compute::Softlayer::KeyPair</a></h1>
</ruby>
<p>Here&rsquo;s how we get key pairs that have already been created:
<ruby></p>
<h1 id="by-id">By id:</h1>
<p>kp = @sl.key_pairs.get(123456)</p>
<h1 id="-fogcomputesoftlayerkeypair-2">=&gt; <a href="Fog::Compute::Softlayer::KeyPair">Fog::Compute::Softlayer::KeyPair</a></h1>
<h1 id="by-label">By label:</h1>
<p>kp = @sl.key_pairs.by_label(&lsquo;my-new-key&rsquo;)</p>
<h1 id="-fogcomputesoftlayerkeypair-3">=&gt; <a href="Fog::Compute::Softlayer::KeyPair">Fog::Compute::Softlayer::KeyPair</a></h1>
</ruby>
<p>Let&rsquo;s destroy a key pair, just for fun.</p>
<ruby>
kp = @sl.key_pairs.by_label('my-new-key')
# => <Fog::Compute::Softlayer::KeyPair>
kp.destroy
</ruby><br>
<p>\t</p>
<h5 id="key-pairs-with-servers">Key Pairs with Servers</h5>
<p>With basic CRUD out of the way on the key pairs, let&rsquo;s see how we can assign them to servers.</p>
<p>Create a server with one or more key pairs using:</p>
<ruby>
the_first_key = @sl.key_pairs.by_label('my-new-key')
# => <Fog::Compute::Softlayer::KeyPair>
the_second_key = @sl.key_pairs.by_label('my-other-new-key')
# => <Fog::Compute::Softlayer::KeyPair>
\t
opts = { 
\t:flavor_id => 'm1.small', 
\t:os_code => 'UBUNTU_LATEST', 
\t:datacenter => 'hkg02', 
\t:name => 'cphrmky', 
\t:key_pairs => [ the_first_key, the_second_key ]
}
@sl.servers.create(opts)
# => <Fog::Compute::Softlayer::Server>
</ruby>
<p>If you already have the list of internal IDs that SoftLayer assigns to each of your key pairs, you can pass an array of hashes instead of loading an object for each key pair you assign to a compute instance.</p>
<ruby>
key_pair_ids = [
\t{:id => 12345},
\t{:id => 12346},
\t{:id => 12347},
]
<p>opts = {
\t:flavor_id =&gt; &lsquo;m1.small&rsquo;,
\t:os_code =&gt; &lsquo;UBUNTU_LATEST&rsquo;,
\t:datacenter =&gt; &lsquo;hkg02&rsquo;,
\t:name =&gt; &lsquo;cphrmky&rsquo;,
\t:key_pairs =&gt; key_pair_ids
}
@sl.servers.create(opts)</p>
<h1 id="-fogcomputesoftlayerserver">=&gt; <a href="Fog::Compute::Softlayer::Server">Fog::Compute::Softlayer::Server</a></h1>
</ruby>
<p>Then, look at the key pairs on a server:</p>
<ruby>
server = @sl.servers.get(12345)
server.key_pairs
# => [ <Fog::Compute::Softlayer::Server>,
# <Fog::Compute::Softlayer::Server>]
</ruby><br>
<h5 id="try-before-you-buy">Try Before You Buy</h5>
<p>One of the excellent features included in <a href="http://github.com/softlayer/fog-softlayer">fog-softlayer</a> (and for all of the supported providers), is fantastic mocking.</p>
<p>Even if you don&rsquo;t have a SoftLayer account, you can download <a href="https://github.com/softlayer/fog-softlayer">fog-softlayer</a> and start testing this code.</p>
<p>Just call <code>Fog.mock!</code> immediately after requiring the gem, run all of the above code examples, and see how easy it is to work with. We&rsquo;re working hard to get full coverage of Mock classes and methods. You may run across a MockNotImplemented exception here or there. If you do, the best course is probably to fork the repo, implement the mock, and open a pull request.</p>
<p>\- Matt</p>
<p>&ndash;</p>
<p>If you have questions about or problems with <a href="http://rubygems.org/gems/fog-softlayer">fog-softlayer</a> open an <a href="https://github.com/softlayer/fog-softlayer/issues">issue</a> or <a href="mailto:matt.eldridge@us.ibm.com?subject=fog-softlayer">email me</a>.</p>

            </div>
        </div>

    </div>
    <hr>
    <div class="row">
        <div class="row">
            <div class="col-md-6">
    <div class="well well-sm" style="word-wrap: break-word;"> 
        <strong>Feedback? <span class="fas fa-comment"/></strong>
            <p>
                If this article contains any error, or leaves any of your questions unanswered, please help us out by 
                opening up a github issue.<br>
                <a class="" href="https://github.com/softlayer/githubio_source/issues/new?title=Feedback%20for%20blog%20-%20Using%20fog-softlayer%20for%20Managing%20Key%20Pairs&body=Feedback+regarding%3A%20https%3a%2f%2fsldn.softlayer.com%2fblog%2fmatteldridge%2fusing-fog-softlayer-managing-key-pairs%2f"> Open an issue</a>
                <i class="fab fa-github" alt="github"></i>
            </p>
    </div>
</div>
        </div>
    </div>
<footer>
    <div class="row">
        <div class="col-sm-12">
            <p>&copy; SoftLayer 2022<br>
            Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
        </div>
    </div>
</footer>
</div>

    <script src="https://sldn.softlayer.com/js/jquery.js"></script>
    <script src="https://sldn.softlayer.com/js/bootstrap.js"></script>
</body>
</html>

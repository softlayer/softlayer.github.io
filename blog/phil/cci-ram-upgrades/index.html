<!doctype html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SoftLayer API Examples, implementations, and release notes.">
    <meta name="author" content="SoftLayer">

    <title>CCI Ram Upgrades - https://sldn.softlayer.com/</title>
    <link rel="canonical" href="https://sldn.softlayer.com/blog/phil/cci-ram-upgrades/">
        <link href="https://sldn.softlayer.com/css/main.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/bootstrap.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/custom.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/monokai.css" rel="stylesheet">
    <link href="https://sldn.softlayer.com/css/highlight/solarized_dark.css" rel="stylesheet">

    <script src="https://sldn.softlayer.com/js/highlight.pack.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
    <link rel="shortcut icon" href="https://sldn.softlayer.com/img/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Lato" />
            

    <script src="https://sldn.softlayer.com/js/jquery-3.3.1.min.js"></script> 
    <script src="https://sldn.softlayer.com/js/sldn.js"></script>


    <link href="https://sldn.softlayer.com/fontawesome/css/fontawesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/brands.min.css" rel="stylesheet" type="text/css">
    <link href="https://sldn.softlayer.com/fontawesome/css/solid.min.css" rel="stylesheet" type="text/css">
    
    <script defer src="https://sldn.softlayer.com/fontawesome/js/solid.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/brands.min.js"></script>
    <script defer src="https://sldn.softlayer.com/fontawesome/js/fontawesome.min.js"></script>

    <script>
		$(document).ready(function() {
			$('table').addClass("table table-hover table-striped")
		})
	</script>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9XPZ9ZBSJE"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-9XPZ9ZBSJE', { 'anonymize_ip': false });
}
</script>

</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://sldn.softlayer.com/">SoftLayer API</a>
            </div>
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav">
                    
                        <li><a href="https://sldn.softlayer.com/article/">Articles</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/reference/softlayerapi">Documentation</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/go/">Go</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/java/">Java</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/perl/">Perl</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/php/">PHP</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/python/">Python</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/rest/">Rest</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/ruby/">Ruby</a></li>
                    
                        <li><a href="https://sldn.softlayer.com/tools/">Tools</a></li>
                    

                    
                </ul>
                <div id="custom-search-input" class="pull-right">
                  <form class="navbar-form" role="search" method="get" action="https://www.bing.com/search">
                    <div class="input-group col-md-12">
                      <input type="text" class="form-control input-md" placeholder="Search" name="q" id="srch-term">
                      <input type="hidden" name="q1" value="site:sldn.softlayer.com" />
                      <div class="input-group-btn">
                        <button class="btn btn-info" type="submit">
                          <i class="glyphicon glyphicon-search"></i>
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
            </div>
        </div>
    </nav>

<div class="container">
    <div class="row">
    
        <div class="col-md-3">
            <div style="word-wrap: break-word;"> 
                <h4>October 26, 2012<br></h4>
            </div>
        </div>
        <div class="col-md-9">

                <strong>Classes <span class="fa fa-book"/></strong>
                
                <br>
                <strong>Tags <span class="fa fa-tags"/></strong>
                
                    <a class="label label-danger" href="https://sldn.softlayer.com/tags/blog">blog</a>
                          
        </div>
    </div>
    <hr>
    <div class="row">
		<div class="col-md-12">
            <div class="well well-sm  article" style="word-wrap: break-word;">
                <div class="article-title">
				    <h1>CCI Ram Upgrades</h1>
                    <small>&lt;p&gt;Sometimes I just can&#39;t be bothered to do things in the normal way. Now, I can enjoy a good ole zen activity like th</small>
                </div>
				
                
				
                <p>Sometimes I just can't be bothered to do things in the "normal" way. Now, I can enjoy a good ole zen activity like the occasional manual data entry, but in general if I have to repeat a task more than a few times I get antsy. And I am not completely unsure that someone smart and sucessful said something good about lazy people. So in my quest for maximum return for minimal effort I find myself collecting various useful snippets and scripts. Today we will go through one in my collection.</p>
<p>Upgrading a CCI through the SLAPI is a fairly straight forward process which invloves creating an order container of type <a href="https://sldn.softlayer.com/reference/datatypes/SoftLayer_Container_Product_Order_Virtual_Guest_Upgrade/">SoftLayer_Container_Product_Order_Virtual_Guest_Upgrade</a>. In addition to the usual suspects this container will also require a property by the name of <span class="geshifilter"><code class="text geshifilter-text">MAINTENANCE_WINDOW</code></span>.</p>
<p>Import the SLAPI, datetime which will provide the current time stamp for our maintenance window and pretty printer because no one likes ugly print...</p>
<div class="geshifilter">
<pre class="python geshifilter-python" style="font-family:monospace;"><span style="color: #ff7700;font-weight:bold;">import</span> SoftLayer.<span style="color: black;">API</span>
<span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">datetime</span>
<span style="color: #ff7700;font-weight:bold;">from</span> <span style="color: #dc143c;">pprint</span> <span style="color: #ff7700;font-weight:bold;">import</span> <span style="color: #dc143c;">pprint</span> <span style="color: #ff7700;font-weight:bold;">as</span> pp</pre></div>
<p>This <a href="https://sldn.softlayer.com/blog/tgarrison/Helper-Functions-Small-Changes-Big-Win">helper function</a> takes in the amount of RAM you wish set for your CCI as an int and returns the prices array needed for the order container. Take note of the anonmyous function on the len() check...nested foreach loops are cool and all, but this is much more fun.</p>
<div class="geshifilter">
<pre class="python geshifilter-python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;"># Find the priceId for the RAM item matching our defined memory allotment</span>
<span style="color: #ff7700;font-weight:bold;">def</span> getMemoryPrice<span style="color: black;">&#40;</span>memoryCapacity<span style="color: black;">&#41;</span>:
    packageClient <span style="color: #66cc66;">=</span> SoftLayer.<span style="color: black;">API</span>.<span style="color: black;">Client</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'SoftLayer_Product_Package'</span><span style="color: #66cc66;">,</span> <span style="color: #ff4500;">46</span><span style="color: #66cc66;">,</span> apiUsername<span style="color: #66cc66;">,</span> apiKey<span style="color: black;">&#41;</span>
    objectMask <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">"mask[capacity;prices.id;categories[name,id]]"</span>
    packageClient.<span style="color: black;">set_object_mask</span><span style="color: black;">&#40;</span>objectMask<span style="color: black;">&#41;</span>
    items <span style="color: #66cc66;">=</span> packageClient.<span style="color: black;">getItems</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
    <span style="color: #ff7700;font-weight:bold;">for</span> item <span style="color: #ff7700;font-weight:bold;">in</span> items:
        <span style="color: #ff7700;font-weight:bold;">if</span> <span style="color: #008000;">len</span><span style="color: black;">&#40;</span><span style="color: #008000;">filter</span><span style="color: black;">&#40;</span><span style="color: #ff7700;font-weight:bold;">lambda</span> x: x.<span style="color: black;">get</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'id'</span><span style="color: black;">&#41;</span> <span style="color: #66cc66;">==</span> <span style="color: #ff4500;">3</span><span style="color: #66cc66;">,</span> item<span style="color: black;">&#91;</span><span style="color: #483d8b;">'categories'</span><span style="color: black;">&#93;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span> \\
        <span style="color: #ff7700;font-weight:bold;">and</span> item.<span style="color: black;">get</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'capacity'</span><span style="color: black;">&#41;</span> <span style="color: #66cc66;">==</span> <span style="color: #008000;">str</span><span style="color: black;">&#40;</span>memoryCapacity<span style="color: black;">&#41;</span>:
            <span style="color: #ff7700;font-weight:bold;">return</span> item<span style="color: black;">&#91;</span><span style="color: #483d8b;">'prices'</span><span style="color: black;">&#93;</span><span style="color: black;">&#91;</span><span style="color: #ff4500;">0</span><span style="color: black;">&#93;</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'id'</span><span style="color: black;">&#93;</span></pre></div>
<p>This function puts all our data together in the needed format then sends it off to processing where the unicorns churn it into server dust.</p>
<div class="geshifilter">
<pre class="python geshifilter-python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;"># Create the upgrade order container and send the order to the API. Replace</span>
<span style="color: #808080; font-style: italic;"># verifyOrder() with placeOrder() after testing</span>
<span style="color: #ff7700;font-weight:bold;">def</span> upgradeOrder<span style="color: black;">&#40;</span>virtualGuestId<span style="color: #66cc66;">,</span> memoryPriceId<span style="color: black;">&#41;</span>:
    orderClient <span style="color: #66cc66;">=</span> SoftLayer.<span style="color: black;">API</span>.<span style="color: black;">Client</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'SoftLayer_Product_Order'</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">None</span><span style="color: #66cc66;">,</span> apiUsername<span style="color: #66cc66;">,</span> apiKey<span style="color: black;">&#41;</span>
    orderContainer <span style="color: #66cc66;">=</span> <span style="color: black;">&#123;</span><span style="color: black;">&#125;</span>
    orderContainer<span style="color: black;">&#91;</span><span style="color: #483d8b;">'complexType'</span><span style="color: black;">&#93;</span> <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">'SoftLayer_Container_Product_Order_Virtual_Guest_Upgrade'</span>
    orderContainer<span style="color: black;">&#91;</span><span style="color: #483d8b;">'virtualGuests'</span><span style="color: black;">&#93;</span> <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: black;">&#123;</span><span style="color: #483d8b;">'id'</span>: virtualGuestId<span style="color: black;">&#125;</span><span style="color: black;">&#93;</span>
    orderContainer<span style="color: black;">&#91;</span><span style="color: #483d8b;">'prices'</span><span style="color: black;">&#93;</span> <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: black;">&#123;</span><span style="color: #483d8b;">'id'</span>: memoryPriceId<span style="color: black;">&#125;</span><span style="color: black;">&#93;</span>
    orderContainer<span style="color: black;">&#91;</span><span style="color: #483d8b;">'properties'</span><span style="color: black;">&#93;</span> <span style="color: #66cc66;">=</span> <span style="color: black;">&#91;</span><span style="color: black;">&#123;</span><span style="color: #483d8b;">'name'</span>: <span style="color: #483d8b;">'MAINTENANCE_WINDOW'</span><span style="color: #66cc66;">,</span> <span style="color: #483d8b;">'value'</span>: <span style="color: #008000;">str</span><span style="color: black;">&#40;</span><span style="color: #dc143c;">datetime</span>.<span style="color: #dc143c;">datetime</span>.<span style="color: black;">now</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#125;</span><span style="color: black;">&#93;</span>
    <span style="color: #ff7700;font-weight:bold;">return</span> orderClient.<span style="color: black;">verifyOrder</span><span style="color: black;">&#40;</span>orderContainer<span style="color: black;">&#41;</span></pre></div>
<p>To wrap up: our implimentation of argsparse to handle the command line arguments, our API username and API key and our call to upgradeOrder which sets the process in motion.</p>
<div class="geshifilter">
<pre class="python geshifilter-python" style="font-family:monospace;"><span style="color: #808080; font-style: italic;"># Define our arguments and start the process</span>
<span style="color: #ff7700;font-weight:bold;">if</span> __name__ <span style="color: #66cc66;">==</span> <span style="color: #483d8b;">"__main__"</span>:
    <span style="color: #ff7700;font-weight:bold;">import</span> argparse
&nbsp;
    argsparse <span style="color: #66cc66;">=</span> argparse.<span style="color: black;">ArgumentParser</span><span style="color: black;">&#40;</span>description<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'Upgrade a CCI<span style="color: #000099; font-weight: bold;">\\'</span>s Memory'</span><span style="color: black;">&#41;</span>
    argsparse.<span style="color: black;">add_argument</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'virtualGuestId'</span><span style="color: #66cc66;">,</span> metavar<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'Virtual Guest ID'</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">type</span><span style="color: #66cc66;">=</span><span style="color: #008000;">int</span><span style="color: #66cc66;">,</span>
        <span style="color: #008000;">help</span><span style="color: #66cc66;">=</span><span style="color: #483d8b;">'ID of the target CCI.'</span><span style="color: black;">&#41;</span>
    argsparse.<span style="color: black;">add_argument</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'memoryCapacity'</span><span style="color: #66cc66;">,</span> metavar<span style="color: #66cc66;">=</span><span style="color: #483d8b;">'Ram GBs'</span><span style="color: #66cc66;">,</span> <span style="color: #008000;">type</span><span style="color: #66cc66;">=</span><span style="color: #008000;">int</span><span style="color: #66cc66;">,</span>
        <span style="color: #008000;">help</span><span style="color: #66cc66;">=</span><span style="color: #483d8b;">'Amount of RAM in GB.'</span><span style="color: black;">&#41;</span>
&nbsp;
    args <span style="color: #66cc66;">=</span> argsparse.<span style="color: black;">parse_args</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span>
&nbsp;
    apiUsername <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">''</span>
    apiKey <span style="color: #66cc66;">=</span> <span style="color: #483d8b;">''</span>
    pp<span style="color: black;">&#40;</span>upgradeOrder<span style="color: black;">&#40;</span>args.<span style="color: black;">virtualGuestId</span><span style="color: #66cc66;">,</span> getMemoryPrice<span style="color: black;">&#40;</span>args.<span style="color: black;">memoryCapacity</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></pre></div>
<p>Now with the syntax <span class="geshifilter"><code class="text geshifilter-text">python upgradeCCI.py <serverId> <ram amount in GB></code></span> we can easily place a RAM upgrade order. Remember to reboot your CCI after the order is complete to take advantage of your newly aquired memory.</p>
<p>-Phil</p>

            </div>
        </div>

    </div>
    <hr>
    <div class="row">
        <div class="row">
            <div class="col-md-6">
    <div class="well well-sm" style="word-wrap: break-word;"> 
        <strong>Feedback? <span class="fas fa-comment"/></strong>
            <p>
                If this article contains any error, or leaves any of your questions unanswered, please help us out by 
                opening up a github issue.<br>
                <a class="" href="https://github.com/softlayer/githubio_source/issues/new?title=Feedback%20for%20blog%20-%20CCI%20Ram%20Upgrades&body=Feedback+regarding%3A%20https%3a%2f%2fsldn.softlayer.com%2fblog%2fphil%2fcci-ram-upgrades%2f"> Open an issue</a>
                <i class="fab fa-github" alt="github"></i>
            </p>
    </div>
</div>
        </div>
    </div>
<footer>
    <div class="row">
        <div class="col-sm-12">
            <p>&copy; SoftLayer 2022<br>
            Built with <a href="https://github.com/spf13/hugo">Hugo</a></p>
        </div>
    </div>
</footer>
</div>

    <script src="https://sldn.softlayer.com/js/jquery.js"></script>
    <script src="https://sldn.softlayer.com/js/bootstrap.js"></script>
</body>
</html>
